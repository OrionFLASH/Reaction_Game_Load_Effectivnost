#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–æ–≤
–ê–≤—Ç–æ—Ä: AI Assistant
–í–µ—Ä—Å–∏—è: 1.0.0
–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 2024
"""

import os
import sys
import time
import logging
import pandas as pd
import numpy as np
from openpyxl import load_workbook
from openpyxl.styles import Alignment
from datetime import datetime
from pathlib import Path
import traceback

# =============================================================================
# –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ù–ê–°–¢–†–û–ô–ö–ò –ü–†–û–ì–†–ê–ú–ú–´
# =============================================================================

# –ü—É—Ç—å –∫ —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–µ (—Å—ã—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)
WORK_DIR = r"/Users/orionflash/Desktop/MyProject/Reaction_Effectiv_LOAD/WORK"

# –ù–∞–∑–≤–∞–Ω–∏—è –ø–æ–¥–ø–∞–ø–æ–∫
INPUT_FOLDER = "INPUT"      # –ü–∞–ø–∫–∞ —Å –≤—Ö–æ–¥–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
OUTPUT_FOLDER = "OUTPUT"    # –ü–∞–ø–∫–∞ —Å –≤—ã—Ö–æ–¥–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
LOGS_FOLDER = "LOGS"        # –ü–∞–ø–∫–∞ —Å –ª–æ–≥–∞–º–∏

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (–∏–º—è –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ)
INPUT_FILES = [
    {"name": "data1_20250822_153515", "extension": ".xlsx"},
    {"name": "data2_20250822_153515", "extension": ".xlsx"}
]

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
OUTPUT_FILES = [
    {"name": "processed_data", "extension": ".xlsx", "suffix_format": "_YYYYMMDD-HHMMSS"}
    # –ó–ê–ö–õ–ê–î–ö–ê –î–õ–Ø –ë–£–î–£–©–ï–ì–û CSV:
    # {"name": "processed_data", "extension": ".csv", "suffix_format": "_YYYYMMDD-HHMMSS"}
]

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥-—Ñ–∞–π–ª–∞
LOG_FILE = {
    "name": "processing_log",
    "extension": ".log",
    "suffix_format": "_YYYYMMDD"
}

# –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã
# "process" - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–æ—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞)
# "create-test" - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
PROGRAM_MODE = "process"
#PROGRAM_MODE = "create-test"

# –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (INFO –∏–ª–∏ DEBUG)
LOG_LEVEL = "DEBUG"

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
DATA_PARAMS = {
    "total_employees": 1600,        # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
    "effective_share": 0.80,        # –î–æ–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (80%)
    "operational_income_final_min": 500000,    # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è 2025 (—Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥, —Ç—ã—Å. —Ä—É–±.)
    "operational_income_final_max": 220000000,   # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è 2025 (—Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥, —Ç—ã—Å. —Ä—É–±.)
    "operational_income_current_min": 500000,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 (—Ç–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥, —Ç—ã—Å. —Ä—É–±.)
    "operational_income_current_max": 220000000, # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 (—Ç–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥, —Ç—ã—Å. —Ä—É–±.)
    "employee_overlap": 0.90,       # –î–æ–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –¥–≤—É—Ö —Ñ–∞–π–ª–∞—Ö (90%)
    "new_employees_share": 0.05,    # –î–æ–ª—è –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (5%)
    "removed_employees_share": 0.05 # –î–æ–ª—è —É–±—Ä–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (5%)
}

# –ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è (25%, 50%, 75%)
PERCENTILES = [25, 50, 75]

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ Excel
# –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
# 
# –ü–ê–†–ê–ú–ï–¢–†–´ –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–Ø:
# - 'format': —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö ('text', 'number', 'date')
# - 'width': —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–∫–∏ –≤ —Å–∏–º–≤–æ–ª–∞—Ö
# - 'alignment': –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ ('left', 'center', 'right')
# - 'number_format': —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç (—Ç–æ–ª—å–∫–æ –¥–ª—è format='number')
#
# –ß–ò–°–õ–û–í–´–ï –§–û–†–ú–ê–¢–´:
# - '0' - —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ
# - '0.0' - —á–∏—Å–ª–æ —Å 1 –∑–Ω–∞–∫–æ–º –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
# - '#,##0.0' - —á–∏—Å–ª–æ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ —Ä–∞–∑—Ä—è–¥–æ–≤ –∏ 1 –∑–Ω–∞–∫–æ–º –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
# - '#,##0' - —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ —Ä–∞–∑—Ä—è–¥–æ–≤
# - '0.00%' - –ø—Ä–æ—Ü–µ–Ω—Ç —Å 2 –∑–Ω–∞–∫–∞–º–∏ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
#
# –î–ê–¢–´:
# - 'DD.MM.YYYY' - –¥–µ–Ω—å.–º–µ—Å—è—Ü.–≥–æ–¥
# - 'MM/DD/YYYY' - –º–µ—Å—è—Ü/–¥–µ–Ω—å/–≥–æ–¥
# - 'YYYY-MM-DD' - –≥–æ–¥-–º–µ—Å—è—Ü-–¥–µ–Ω—å
#
# –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø:
# - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ: {'format': 'number', 'number_format': '#,##0.0', 'alignment': 'right'}
# - –ü—Ä–æ—Ü–µ–Ω—Ç—ã: {'format': 'number', 'number_format': '0.0%', 'alignment': 'center'}
# - –î–∞—Ç—ã: {'format': 'date', 'number_format': 'DD.MM.YYYY', 'alignment': 'center'}
# - –¢–µ–∫—Å—Ç: {'format': 'text', 'alignment': 'left'}
# –ì—Ä—É–ø–ø—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫
COLUMN_FORMAT_GROUPS = {
    # –¢–ï–ö–°–¢–û–í–´–ï –ö–û–õ–û–ù–ö–ò (–ª–µ–≤–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ)
    'text_left': {
        'columns': ['–¢–ë', '–ì–û–°–ë', '–§–ò–û', '–≤—ã–≤–æ–¥'],
        'format': 'text',
        'width': 20,
        'alignment': 'left'
    },
    
    # –¶–ï–ù–¢–†–ò–†–û–í–ê–ù–ù–´–ï –ö–û–õ–û–ù–ö–ò
    'text_center': {
        'columns': ['–≠–§.–ö–ú', '–≤—ã–ø —É—Å–ª–æ–≤–∏–π', '–ö–û–î –≤—ã–≤–æ–¥–∞'],
        'format': 'text', 
        'width': 12,
        'alignment': 'center'
    },
    
    # –§–ò–ù–ê–ù–°–û–í–´–ï –î–ê–ù–ù–´–ï (—Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ —Ä–∞–∑—Ä—è–¥–æ–≤, 1 –∑–Ω–∞–∫ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)
    'financial': {
        'columns': ['–û–î –¢–ï–ö–£–©–ò–ô', '–û–î –ü–†–û–®–õ–´–ô', '–ø—Ä–∏—Ä–æ—Å—Ç'],
        'format': 'number',
        'number_format': '#,##0.0',
        'width': 18,
        'alignment': 'right'
    },
    
    # –ü–†–û–¶–ï–ù–¢–ò–õ–ò (—Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ —Ä–∞–∑—Ä—è–¥–æ–≤, 1 –∑–Ω–∞–∫ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)
    'percentiles': {
        'columns': ['–°–¢–†–ê–ù–ê 50', '–°–¢–†–ê–ù–ê 75', '–°–¢–†–ê–ù–ê 90', '–¢–ë 25', '–¢–ë 50', '–¢–ë 75', '–ì–û–°–ë 25', '–ì–û–°–ë 50', '–ì–û–°–ë 75'],
        'format': 'number',
        'number_format': '#,##0.0',
        'width': 15,
        'alignment': 'right'
    },
    
    # –†–ê–ù–ì–ò (1 –∑–Ω–∞–∫ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)
    'ranks': {
        'columns': ['—Ä–∞–Ω–≥ –û–î BANK', '—Ä–∞–Ω–≥ –û–î TB', '—Ç–µ–º–ø'],
        'format': 'number',
        'number_format': '0.0',
        'width': 15,
        'alignment': 'right'
    },
    
    # –¶–ï–õ–´–ï –ß–ò–°–õ–ê
    'integers': {
        'columns': ['—á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∞', '—á–∏—Å–ª–æ –¢–ë', '—á–∏—Å–ª–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ'],
        'format': 'number',
        'number_format': '0',
        'width': 15,
        'alignment': 'right'
    }
}

# –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≥—Ä—É–ø–ø–æ–≤—ã–µ)
# 
# –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –¢–ò–ü–´ –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–Ø:
# - 'padded_number': —á–∏—Å–ª–æ —Å –ª–∏–¥–∏—Ä—É—é—â–∏–º–∏ –Ω—É–ª—è–º–∏ –¥–æ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–Ω–∞–∫–æ–≤
#   - 'total_digits': –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10)
#   - 'leading_zeros': –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏–¥–∏—Ä—É—é—â–∏—Ö –Ω—É–ª–µ–π (–æ–±—ã—á–Ω–æ —Ä–∞–≤–Ω–æ total_digits)
#   - 'min_value': –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
#   - 'max_value': –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
#
# –ü–†–ò–ú–ï–†–´ –ù–ê–°–¢–†–û–ô–ö–ò –¢–ù 10:
# - 10 –∑–Ω–∞–∫–æ–≤, –≤—Å–µ–≥–¥–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –Ω—É–ª—è–º–∏: {'total_digits': 10, 'leading_zeros': 10}
# - 8 –∑–Ω–∞–∫–æ–≤, –º–∏–Ω–∏–º—É–º 2 –Ω—É–ª—è: {'total_digits': 8, 'leading_zeros': 2}
# - 12 –∑–Ω–∞–∫–æ–≤, –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π: {'total_digits': 12, 'leading_zeros': 0}
#
COLUMN_SPECIAL_FORMATS = {
    '–¢–ù 10': {
        'width': 12,              # –®–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–∫–∏
        'format_type': 'padded_number',  # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–∏–ø —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        'total_digits': 10,       # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞–∫–æ–≤
        'leading_zeros': 10,      # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏–¥–∏—Ä—É—é—â–∏—Ö –Ω—É–ª–µ–π (–≤—Å–µ–≥–¥–∞ –∑–∞–ø–æ–ª–Ω—è–µ–º –¥–æ 10 –∑–Ω–∞–∫–æ–≤)
        'min_value': 1,           # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        'max_value': 9999999999   # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (10 –∑–Ω–∞–∫–æ–≤)
    },
    '–¢–ë': {'width': 20},         # –ù–∞–∑–≤–∞–Ω–∏—è –±–∞–Ω–∫–æ–≤
    '–ì–û–°–ë': {'width': 30},       # –ù–∞–∑–≤–∞–Ω–∏—è –æ—Ç–¥–µ–ª–µ–Ω–∏–π
    '–§–ò–û': {'width': 25},        # –§–ò–û —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
    '–≤—ã–≤–æ–¥': {'width': 40}       # –¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è
}

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –±–∞–Ω–∫–æ–≤ –∏ –∏—Ö –≥–æ–ª–æ–≤–Ω—ã—Ö –æ—Ç–¥–µ–ª–µ–Ω–∏–π
# –í–ª–æ–∂–µ–Ω–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å: –¢–ë -> —Å–ø–∏—Å–æ–∫ –ì–û–°–ë
BANK_STRUCTURE = {
    "–ë–∞–π–∫–∞–ª—å—Å–∫–∏–π –±–∞–Ω–∫": [
        "–ê–ø–ø–∞—Ä–∞—Ç –ë–∞–π–∫–∞–ª—å—Å–∫–æ–≥–æ –ë–∞–Ω–∫–∞",
        "–ë—É—Ä—è—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8601",
        "–ò—Ä–∫—É—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8586",
        "–ß–∏—Ç–∏–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8600",
        "–Ø–∫—É—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8603"
    ],
    
    "–í–æ–ª–≥–æ-–í—è—Ç—Å–∫–∏–π –±–∞–Ω–∫": [
        "–ê–ø–ø–∞—Ä–∞—Ç –í–æ–ª–≥–æ-–í—è—Ç—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞",
        "–ë–∞–Ω–∫ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω –ì–û–°–ë ‚Ññ8610",
        "–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8611",
        "–ì–æ–ª–æ–≤–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "–ö–∏—Ä–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8612",
        "–ú–∞—Ä–∏–π –≠–ª –ì–û–°–ë ‚Ññ8614",
        "–ú–æ—Ä–¥–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8589",
        "–ü–µ—Ä–º—Å–∫–æ–µ –ì–û–°–ë ‚Ññ6984",
        "–£–¥–º—É—Ä—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8618",
        "–ß—É–≤–∞—à—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8613"
    ],
    
    "–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–π –±–∞–Ω–∫": [
        "–ê–ø–ø–∞—Ä–∞—Ç –î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω–æ–≥–æ –±–∞–Ω–∫–∞",
        "–ë–∏—Ä–æ–±–∏–¥–∂–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ4157",
        "–ë–ª–∞–≥–æ–≤–µ—â–µ–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8636",
        "–ö–∞–º—á–∞—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8556",
        "–ü—Ä–∏–º–æ—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8635",
        "–°–µ–≤–µ—Ä–æ-–í–æ—Å—Ç–æ—á–Ω–æ–µ –ì–û–°–ë ‚Ññ8645",
        "–•–∞–±–∞—Ä–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ9070",
        "–ß—É–∫–æ—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8557",
        "–Æ–∂–Ω–æ-–°–∞—Ö–∞–ª–∏–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8567"
    ],
    
    "–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –±–∞–Ω–∫": [
        "–£–ü–†–ê–í–õ–ï–ù–ò–ï –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã",
        "–£–ü–†–ê–í–õ–ï–ù–ò–ï –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏",
        "–£–ü–†–ê–í–õ–ï–ù–ò–ï –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏ —Å—Ñ–µ—Ä—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏",
        "–£–ü–†–ê–í–õ–ï–ù–ò–ï –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏ —Å—Ñ–µ—Ä—ã —É—Å–ª—É–≥",
        "–£–ü–†–ê–í–õ–ï–ù–ò–ï –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏"
    ],
    
    "–ü–æ–≤–æ–ª–∂—Å–∫–∏–π –±–∞–Ω–∫": [
        "–ê–ø–ø–∞—Ä–∞—Ç –ü–æ–≤–æ–ª–∂—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞",
        "–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8625",
        "–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8621",
        "–û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8623",
        "–ü–µ–Ω–∑–µ–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8624",
        "–°–∞–º–∞—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ6991",
        "–°–∞—Ä–∞—Ç–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8622",
        "–£–ª—å—è–Ω–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8588"
    ],
    
    "–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –±–∞–Ω–∫": [
        "–ê–ø–ø–∞—Ä–∞—Ç –°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω–æ–≥–æ –±–∞–Ω–∫–∞",
        "–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8637",
        "–í–æ–ª–æ–≥–æ–¥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8638",
        "–ì–û –ø–æ –≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥—É",
        "–ì–û –ø–æ –õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8626",
        "–ö–∞—Ä–µ–ª—å—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8628",
        "–ö–æ–º–∏ –ì–û–°–ë ‚Ññ8617",
        "–ú—É—Ä–º–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8627",
        "–ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8629",
        "–ü—Å–∫–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8630"
    ],
    
    "–°–∏–±–∏—Ä—Å–∫–∏–π –±–∞–Ω–∫": [
        "–ê–ø–ø–∞—Ä–∞—Ç –°–∏–±–∏—Ä—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞",
        "–ê–±–∞–∫–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8602",
        "–ê–ª—Ç–∞–π—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8644",
        "–ö–µ–º–µ—Ä–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8615",
        "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8646",
        "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8047",
        "–û–º—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8634",
        "–¢–æ–º—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8616"
    ],
    
    "–°—Ä–µ–¥–Ω–µ—Ä—É—Å—Å–∫–∏–π –±–∞–Ω–∫": [
        "–ê–ø–ø–∞—Ä–∞—Ç –°—Ä–µ–¥–Ω–µ—Ä—É—Å—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞",
        "–ë—Ä—è–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8605",
        "–í–æ—Å—Ç–æ—á–Ω–æ–µ –ì–û–°–ë ‚Ññ1023",
        "–ó–∞–ø–∞–¥–Ω–æ–µ –ì–û–°–ë ‚Ññ1025",
        "–ò–≤–∞–Ω–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8639",
        "–ö–∞–ª—É–∂—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8608",
        "–ö–æ—Å—Ç—Ä–æ–º—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8640",
        "–†—è–∑–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8606",
        "–°–µ–≤–µ—Ä–Ω–æ–µ –ì–û–°–ë ‚Ññ1026",
        "–°–º–æ–ª–µ–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8609",
        "–¢–≤–µ—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8607",
        "–¢—É–ª—å—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8604",
        "–Æ–∂–Ω–æ–µ –ì–û–°–ë ‚Ññ1024",
        "–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ17"
    ],
    
    "–£—Ä–∞–ª—å—Å–∫–∏–π –±–∞–Ω–∫": [
        "–ê–ø–ø–∞—Ä–∞—Ç –£—Ä–∞–ª—å—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞",
        "–ë–∞—à–∫–∏—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8598",
        "–ó–∞–ø–∞–¥–Ω–æ-–°–∏–±–∏—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8647",
        "–ö—É—Ä–≥–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8599",
        "–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ7003",
        "–ß–µ–ª—è–±–∏–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8597",
        "–Æ–≥–æ—Ä—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ ‚Ññ5940",
        "–Ø–º–∞–ª–æ-–ù–µ–Ω–µ—Ü–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ ‚Ññ8369"
    ],
    
    "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ-–ß–µ—Ä–Ω–æ–∑–µ–º–Ω—ã–π –±–∞–Ω–∫": [
        "–ê–ø–ø–∞—Ä–∞—Ç –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ-–ß–µ—Ä–Ω–æ–∑–µ–º–Ω–æ–≥–æ –±–∞–Ω–∫–∞",
        "–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8592",
        "–ì–û –ø–æ –í–æ—Ä–æ–Ω–µ–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "–ì–æ–ª–æ–≤–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –ø–æ –õ–ù–†",
        "–ö—É—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8596",
        "–õ–∏–ø–µ—Ü–∫–æ–µ –ì–û–°–ë ‚Ññ8593",
        "–û—Ä–ª–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8595",
        "–¢–∞–º–±–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8594"
    ],
    
    "–Æ–≥–æ-–ó–∞–ø–∞–¥–Ω—ã–π –±–∞–Ω–∫": [
        "–ê–ø–ø–∞—Ä–∞—Ç –Æ–≥–æ-–ó–∞–ø–∞–¥–Ω–æ–≥–æ –±–∞–Ω–∫–∞",
        "–ê–¥—ã–≥–µ–π—Å–∫–æ–µ –û–°–ë ‚Ññ8620",
        "–ì–æ–ª–æ–≤–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –ø–æ –î–ù–†",
        "–ì–æ–ª–æ–≤–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –ø–æ –†–µ—Å–ø—É–±–ª–∏–∫–µ –ö—Ä—ã–º",
        "–ò–Ω–≥—É—à—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ ‚Ññ 8633",
        "–ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä—Å–∫–æ–µ –û–°–ë ‚Ññ8631",
        "–ö–∞–ª–º—ã—Ü–∫–æ–µ –û–°–ë ‚Ññ8579",
        "–ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å—Å–∫–æ–µ –û–°–ë ‚Ññ8585",
        "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8619",
        "–†–æ—Å—Ç–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ5221",
        "–°–µ–≤–µ—Ä–æ-–û—Å–µ—Ç–∏–Ω—Å–∫–æ–µ –û–°–ë ‚Ññ8632",
        "–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–æ–µ –ì–û–°–ë ‚Ññ5230",
        "–ß–µ—á–µ–Ω—Å–∫–æ–µ –û–°–ë ‚Ññ8643"
    ]
}

# –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
TERRITORIAL_BANKS = list(BANK_STRUCTURE.keys())
HEAD_OFFICES = [gosb for gosb_list in BANK_STRUCTURE.values() for gosb in gosb_list]

# –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
LOG_MESSAGES = {
    "start": "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—â–µ–Ω–∞",
    "end": "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞",
    "processing_start": "–ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö",
    "processing_end": "–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞",
    "file_loaded": "–§–∞–π–ª {} –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ",
    "file_saved": "–§–∞–π–ª {} —Å–æ—Ö—Ä–∞–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ",
    "error": "–û—à–∏–±–∫–∞: {}",
    "summary": "–°–≤–æ–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {}",
    "time_elapsed": "–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {}",
    "files_processed": "–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: {}",
    "outputs_created": "–°–æ–∑–¥–∞–Ω–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: {}",
    "errors_count": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫: {}",
    "test_data_created": "–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ",
    "test_file_created": "–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª: {}",
    "test_data_info": "–¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç {} —Å—Ç—Ä–æ–∫ –∏ {} —Å—Ç–æ–ª–±—Ü–æ–≤",
    "data_generation_start": "–ù–∞—á–∞–ª–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
    "data_generation_end": "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞",
    "employees_created": "–°–æ–∑–¥–∞–Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {}",
    "tb_distribution": "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¢–ë: {}",
    "gosb_distribution": "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ì–û–°–ë: {}",
    "effective_distribution": "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö: {}",
    "directory_ready": "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è {} –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ",
    "tb_mapping_created": "–°–æ–∑–¥–∞–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ì–û–°–ë –ø–æ –¢–ë: {} –¢–ë",
    "progress_employees": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {}",
    "unique_tn_fio": "–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {}",
    "duplicate_tn_error": "–û–®–ò–ë–ö–ê: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–µ–ª—å–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤!",
    "duplicate_fio_error": "–û–®–ò–ë–ö–ê: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –§–ò–û!",
    "file_saved_debug": "–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {}",
    "file_size_debug": "–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {} —Å—Ç—Ä–æ–∫, {} —Å—Ç–æ–ª–±—Ü–æ–≤",
    "generation_error": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {}",
    "save_error": "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {}",
    "details_error": "–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏: {}",
    "file_not_found": "–§–∞–π–ª {} –Ω–µ –Ω–∞–π–¥–µ–Ω",
    "load_file_error": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞ {}: {}",
    "no_data_to_process": "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏",
    "no_data_to_save": "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è",
    "data_processed": "–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö: {} —Å—Ç—Ä–æ–∫",
    "rows_columns_loaded": "–ó–∞–≥—Ä—É–∂–µ–Ω–æ {} —Å—Ç—Ä–æ–∫ –∏ {} —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞ {}",
    "duplicates_removed": "–£–¥–∞–ª–µ–Ω–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: {}",
    "missing_values_filled": "–ó–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π: {}",
    "processing_error": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö: {}",
    "critical_error": "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {}",
    "mode_create_test": "–†–µ–∂–∏–º: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
    "mode_process": "–†–µ–∂–∏–º: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö",
    "test_data_success": "–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É INPUT.",
    "process_success": "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É OUTPUT –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.",
    "main_critical_error": "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã: {}",
    "file_saved_debug_old": "–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {}",
    "analysis_file1": "=== –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ 1 (31 –∏—é–ª—è 2025 –≥–æ–¥–∞) ===",
    "analysis_file2": "=== –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ 2 (20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞) ===",
    "analysis_overlap": "=== –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ ===",
    "employees_2024": "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ 2024: {}",
    "employees_2025": "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ 2025: {}",
    "overlap_info": "–ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ): {} ({:.1f}%)",
    "new_employees_info": "–ù–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {} ({:.1f}%)",
    "removed_employees_info": "–£–±—Ä–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {} ({:.1f}%)",
    "unique_tn_fio_file1": "–§–∞–π–ª 1 - –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {}",
    "unique_tn_fio_file2": "–§–∞–π–ª 2 - –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {}",
    "employees_july_count": "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–∞ 31 –∏—é–ª—è: {}",
    "employees_august_count": "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞: {}",
    "overlap_info_detailed": "–ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ): {} ({:.1f}%)",
    "new_employees_info_detailed": "–ù–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {} ({:.1f}%)",
    "removed_employees_info_detailed": "–£–±—Ä–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {} ({:.1f}%)",
    "unique_tn_fio_debug": "–§–∞–π–ª {} - –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {}",
    "files_not_found_error": "–ù–µ –Ω–∞–π–¥–µ–Ω—ã —Ñ–∞–π–ª—ã {}.xlsx –∏–ª–∏ {}.xlsx",
    "files_loaded_debug": "–ó–∞–≥—Ä—É–∂–µ–Ω—ã —Ñ–∞–π–ª—ã: data1 ({} —Å—Ç—Ä–æ–∫), data2 ({} —Å—Ç—Ä–æ–∫)",
    "unique_tn_created": "–°–æ–∑–¥–∞–Ω —Å–ø–∏—Å–æ–∫ –∏–∑ {} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù",
    "ranks_calculation": "–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–Ω–≥–∏ –û–î...",
    "percentiles_calculation": "–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏...",
    "ranking_calculation": "–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º...",
    "data_processed_debug": "–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö: {} —Å—Ç—Ä–æ–∫, {} –∫–æ–ª–æ–Ω–æ–∫",
    "load_time_debug": "–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤: {}",
    "process_time_debug": "–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö: {}",
    "save_time_debug": "–í—Ä–µ–º—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤: {}",
    "file1_info": "–§–∞–π–ª 1 (31 –∏—é–ª—è) - –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {}",
    "file2_info": "–§–∞–π–ª 2 (20 –∞–≤–≥—É—Å—Ç–∞) - –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {}",
    "files_loaded_info": "–ó–∞–≥—Ä—É–∂–µ–Ω—ã —Ñ–∞–π–ª—ã: data1 ({} —Å—Ç—Ä–æ–∫), data2 ({} —Å—Ç—Ä–æ–∫)",
    "unique_tn_list_created": "–°–æ–∑–¥–∞–Ω —Å–ø–∏—Å–æ–∫ –∏–∑ {} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù",
    "data_processing_time": "–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö: {}",
    "data_processed_info": "–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö: {} —Å—Ç—Ä–æ–∫, {} –∫–æ–ª–æ–Ω–æ–∫",
    "file_loading_time": "–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤: {}",
    "file_saving_time": "–í—Ä–µ–º—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤: {}",
    "files_not_found": "–ù–µ –Ω–∞–π–¥–µ–Ω—ã —Ñ–∞–π–ª—ã {}.xlsx –∏–ª–∏ {}.xlsx",
    "autofilter_added": "–î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ—Ñ–∏–ª—å—Ç—Ä –Ω–∞ –¥–∏–∞–ø–∞–∑–æ–Ω {}",
    "panes_frozen": "–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Ñ–∏–∫—Å–∞—Ü–∏—è –ø–∞–Ω–µ–ª–µ–π –Ω–∞ —É—Ä–æ–≤–Ω–µ A2 (–∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤–∏–¥–Ω—ã)",
    "columns_formatted": "–û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω—ã {} –∫–æ–ª–æ–Ω–æ–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É",
    "group_formatting_applied": "–ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≥—Ä—É–ø–ø–æ–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: {} –≥—Ä—É–ø–ø, {} –∫–æ–ª–æ–Ω–æ–∫",
    "special_formats_applied": "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫ {} –∫–æ–ª–æ–Ω–∫–∞–º",
    "padded_number_formatted": "–ü—Ä–∏–º–µ–Ω–µ–Ω–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ {} –∫–æ–ª–æ–Ω–∫–∞–º (padded_number)"
}

# =============================================================================
# –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
# =============================================================================

def format_execution_time(seconds):
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç MM:SS.mmm
    
    Args:
        seconds (float): –í—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        
    Returns:
        str: –í—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ MM:SS.mmm
    """
    if seconds < 60:
        return f"00:{seconds:06.3f}"
    else:
        minutes = int(seconds // 60)
        remaining_seconds = seconds % 60
        return f"{minutes:02d}:{remaining_seconds:06.3f}"

# =============================================================================
# –ö–õ–ê–°–° –î–õ–Ø –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø
# =============================================================================

class DataProcessorLogger:
    """–ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
    
    def __init__(self, log_dir, log_name, log_extension, suffix_format, level="INFO"):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–≥–µ—Ä–∞
        
        Args:
            log_dir (str): –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –ª–æ–≥–æ–≤
            log_name (str): –ò–º—è –ª–æ–≥-—Ñ–∞–π–ª–∞ –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
            log_extension (str): –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ª–æ–≥-—Ñ–∞–π–ª–∞
            suffix_format (str): –§–æ—Ä–º–∞—Ç —Å—É—Ñ—Ñ–∏–∫—Å–∞ –¥–ª—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
            level (str): –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (INFO/DEBUG)
        """
        self.log_dir = Path(log_dir)
        self.log_name = log_name
        self.log_extension = log_extension
        self.suffix_format = suffix_format
        self.level = level.upper()
        
        # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ª–æ–≥–æ–≤ –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
        self.log_dir.mkdir(parents=True, exist_ok=True)
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º—è –ª–æ–≥-—Ñ–∞–π–ª–∞ —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º
        timestamp = datetime.now().strftime(suffix_format.replace("YYYY", "%Y").replace("MM", "%m").replace("DD", "%d"))
        self.log_filename = f"{log_name}-{level}{timestamp}{log_extension}"
        self.log_filepath = self.log_dir / self.log_filename
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        self._setup_logging()
    
    def _setup_logging(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"""
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        log_level = logging.DEBUG if self.level == "DEBUG" else logging.INFO
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä
        formatter = logging.Formatter(
            '%(asctime)s - %(levelname)s - %(message)s',
            datefmt='%Y-%m-%d %H:%M:%S'
        )
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ñ–∞–π–ª–æ–≤—ã–π —Ö–µ–Ω–¥–ª–µ—Ä
        file_handler = logging.FileHandler(self.log_filepath, encoding='utf-8')
        file_handler.setLevel(log_level)
        file_handler.setFormatter(formatter)
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ö–µ–Ω–¥–ª–µ—Ä
        console_handler = logging.StreamHandler()
        console_handler.setLevel(log_level)
        console_handler.setFormatter(formatter)
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–æ—Ä–Ω–µ–≤–æ–π –ª–æ–≥–≥–µ—Ä
        self.logger = logging.getLogger(__name__)
        self.logger.setLevel(log_level)
        self.logger.addHandler(file_handler)
        self.logger.addHandler(console_handler)
        
        # –û—á–∏—â–∞–µ–º —Ö–µ–Ω–¥–ª–µ—Ä—ã —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
        self.logger.handlers.clear()
        self.logger.addHandler(file_handler)
        self.logger.addHandler(console_handler)
    
    def log_info(self, message):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è"""
        self.logger.info(message)
    
    def log_debug(self, message):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è"""
        self.logger.debug(message)
    
    def log_error(self, message):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"""
        self.logger.error(message)
    
    def log_start(self):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
        self.log_info(LOG_MESSAGES["start"])
    
    def log_end(self):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
        self.log_info(LOG_MESSAGES["end"])

# =============================================================================
# –ö–õ–ê–°–° –î–õ–Ø –°–û–ó–î–ê–ù–ò–Ø –¢–ï–°–¢–û–í–´–• –î–ê–ù–ù–´–•
# =============================================================================

class TestDataGenerator:
    """–ö–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
    
    def __init__(self, work_dir, logger):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        
        Args:
            work_dir (str): –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
            logger (DataProcessorLogger): –û–±—ä–µ–∫—Ç –ª–æ–≥–≥–µ—Ä–∞
        """
        self.work_dir = Path(work_dir)
        self.logger = logger
        self.start_time = None
        self.errors_count = 0
        self.files_created = 0
        self.employees_created = 0
        
        # –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        self._create_directories()
        
        # –°–æ–∑–¥–∞–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ì–û–°–ë –ø–æ –¢–ë
        self._create_tb_gosb_mapping()
    
    def _create_directories(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π"""
        directories = [
            self.work_dir / INPUT_FOLDER,
            self.work_dir / OUTPUT_FOLDER,
            self.work_dir / LOGS_FOLDER
        ]
        
        for directory in directories:
            directory.mkdir(parents=True, exist_ok=True)
            self.logger.log_debug(LOG_MESSAGES["directory_ready"].format(directory))
    
    def _create_tb_gosb_mapping(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ì–û–°–ë –ø–æ –¢–ë"""
        self.tb_gosb_mapping = {}
        current_index = 0
        
        for tb in TERRITORIAL_BANKS:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ì–û–°–ë –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –¢–ë
            if tb == "–ë–∞–π–∫–∞–ª—å—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 5
            elif tb == "–í–æ–ª–≥–æ-–í—è—Ç—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 12
            elif tb == "–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–π –±–∞–Ω–∫":
                gosb_count = 9
            elif tb == "–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 5
            elif tb == "–ü–æ–≤–æ–ª–∂—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 8
            elif tb == "–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –±–∞–Ω–∫":
                gosb_count = 10
            elif tb == "–°–∏–±–∏—Ä—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 8
            elif tb == "–°—Ä–µ–¥–Ω–µ—Ä—É—Å—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 13
            elif tb == "–£—Ä–∞–ª—å—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 7
            elif tb == "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ-–ß–µ—Ä–Ω–æ–∑–µ–º–Ω—ã–π –±–∞–Ω–∫":
                gosb_count = 8
            elif tb == "–Æ–≥–æ-–ó–∞–ø–∞–¥–Ω—ã–π –±–∞–Ω–∫":
                gosb_count = 12
            else:
                gosb_count = 10
            
            # –ë–µ—Ä–µ–º –ì–û–°–ë –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –¢–ë
            self.tb_gosb_mapping[tb] = HEAD_OFFICES[current_index:current_index + gosb_count]
            current_index += gosb_count
        
        self.logger.log_debug(LOG_MESSAGES["tb_mapping_created"].format(len(self.tb_gosb_mapping)))
    
    def _generate_tn(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∞–±–µ–ª—å–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º"""
        # –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –¢–ù 10
        tn_format = COLUMN_SPECIAL_FORMATS.get('–¢–ù 10', {})
        total_digits = tn_format.get('total_digits', 10)
        leading_zeros = tn_format.get('leading_zeros', 10)
        min_value = tn_format.get('min_value', 1)
        max_value = tn_format.get('max_value', 9999999999)
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
        tn_number = np.random.randint(min_value, max_value + 1)
        
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Å –ª–∏–¥–∏—Ä—É—é—â–∏–º–∏ –Ω—É–ª—è–º–∏ –¥–æ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–Ω–∞–∫–æ–≤
        # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É —Å –ª–∏–¥–∏—Ä—É—é—â–∏–º–∏ –Ω—É–ª—è–º–∏
        formatted_tn = str(tn_number).zfill(total_digits)
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞–ø—Ä—è–º—É—é - pandas –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –µ—ë –∫–∞–∫ —Ç–µ–∫—Å—Ç
        return formatted_tn
    
    def _generate_fio(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –§–ò–û"""
        # –°–ø–∏—Å–∫–∏ –∏–º–µ–Ω, —Ñ–∞–º–∏–ª–∏–π –∏ –æ—Ç—á–µ—Å—Ç–≤
        first_names_male = [
            "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–°–µ—Ä–≥–µ–π", "–í–ª–∞–¥–∏–º–∏—Ä", "–î–º–∏—Ç—Ä–∏–π", "–ê–Ω–¥—Ä–µ–π", "–ê–ª–µ–∫—Å–µ–π", "–ú–∞–∫—Å–∏–º", "–ò–≤–∞–Ω", "–ú–∏—Ö–∞–∏–ª", "–ù–∏–∫–æ–ª–∞–π",
            "–ê—Ä—Ç–µ–º", "–î–µ–Ω–∏—Å", "–ï–≤–≥–µ–Ω–∏–π", "–î–∞–Ω–∏–∏–ª", "–†–æ–º–∞–Ω", "–¢–∏–º—É—Ä", "–í–ª–∞–¥–∏—Å–ª–∞–≤", "–ü–∞–≤–µ–ª", "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω", "–ò–≥–æ—Ä—å"
        ]
        
        first_names_female = [
            "–ê–Ω–Ω–∞", "–ú–∞—Ä–∏—è", "–ï–ª–µ–Ω–∞", "–û–ª—å–≥–∞", "–¢–∞—Ç—å—è–Ω–∞", "–ù–∞—Ç–∞–ª—å—è", "–ò—Ä–∏–Ω–∞", "–°–≤–µ—Ç–ª–∞–Ω–∞", "–Æ–ª–∏—è", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞",
            "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–î–∞—Ä—å—è", "–ö—Å–µ–Ω–∏—è", "–í–∏–∫—Ç–æ—Ä–∏—è", "–ü–æ–ª–∏–Ω–∞", "–ê–ª–∏—Å–∞", "–°–æ—Ñ–∏—è", "–í–µ—Ä–æ–Ω–∏–∫–∞", "–ê—Ä–∏–Ω–∞", "–î–∏–∞–Ω–∞"
        ]
        
        last_names = [
            "–ò–≤–∞–Ω–æ–≤", "–°–º–∏—Ä–Ω–æ–≤", "–ö—É–∑–Ω–µ—Ü–æ–≤", "–ü–æ–ø–æ–≤", "–í–∞—Å–∏–ª—å–µ–≤", "–ü–µ—Ç—Ä–æ–≤", "–°–æ–∫–æ–ª–æ–≤", "–ú–∏—Ö–∞–π–ª–æ–≤", "–ù–æ–≤–∏–∫–æ–≤", "–§–µ–¥–æ—Ä–æ–≤",
            "–ú–æ—Ä–æ–∑–æ–≤", "–í–æ–ª–∫–æ–≤", "–ê–ª–µ–∫—Å–µ–µ–≤", "–õ–µ–±–µ–¥–µ–≤", "–°–µ–º–µ–Ω–æ–≤", "–ï–≥–æ—Ä–æ–≤", "–ü–∞–≤–ª–æ–≤", "–ö–æ–∑–ª–æ–≤", "–°—Ç–µ–ø–∞–Ω–æ–≤", "–ù–∏–∫–æ–ª–∞–µ–≤"
        ]
        
        middle_names_male = [
            "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", "–°–µ—Ä–≥–µ–µ–≤–∏—á", "–í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á", "–î–º–∏—Ç—Ä–∏–µ–≤–∏—á", "–ê–Ω–¥—Ä–µ–µ–≤–∏—á", "–ê–ª–µ–∫—Å–µ–µ–≤–∏—á", "–ú–∞–∫—Å–∏–º–æ–≤–∏—á", "–ò–≤–∞–Ω–æ–≤–∏—á", "–ú–∏—Ö–∞–π–ª–æ–≤–∏—á", "–ù–∏–∫–æ–ª–∞–µ–≤–∏—á"
        ]
        
        middle_names_female = [
            "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞", "–°–µ—Ä–≥–µ–µ–≤–Ω–∞", "–í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞", "–î–º–∏—Ç—Ä–∏–µ–≤–Ω–∞", "–ê–Ω–¥—Ä–µ–µ–≤–Ω–∞", "–ê–ª–µ–∫—Å–µ–µ–≤–Ω–∞", "–ú–∞–∫—Å–∏–º–æ–≤–Ω–∞", "–ò–≤–∞–Ω–æ–≤–Ω–∞", "–ú–∏—Ö–∞–π–ª–æ–≤–Ω–∞", "–ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞"
        ]
        
        # –í—ã–±–∏—Ä–∞–µ–º –ø–æ–ª —Å–ª—É—á–∞–π–Ω–æ
        is_male = np.random.choice([True, False])
        
        if is_male:
            first_name = np.random.choice(first_names_male)
            middle_name = np.random.choice(middle_names_male)
        else:
            first_name = np.random.choice(first_names_female)
            middle_name = np.random.choice(middle_names_female)
        
        last_name = np.random.choice(last_names)
        
        return f"{last_name} {first_name} {middle_name}"
    
    def _generate_effective_status(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
        # 80% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö, 20% –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö
        is_effective = np.random.random() < DATA_PARAMS["effective_share"]
        return "üëç" if is_effective else "üëé"
    
    def _generate_operational_income_data(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–± –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º –¥–æ—Ö–æ–¥–µ"""
        # –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è 2025 (—Ñ–∏–Ω–∞–ª—å–Ω—ã–π)
        income_july = np.random.randint(DATA_PARAMS["operational_income_final_min"], DATA_PARAMS["operational_income_final_max"] + 1)
        
        # –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 (—Ç–µ–∫—É—â–∏–π, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ >= —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ)
        # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ = –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π = –∑–∞–¥–∞–Ω–Ω—ã–π –º–∞–∫—Å–∏–º—É–º
        income_august = np.random.randint(income_july, DATA_PARAMS["operational_income_current_max"] + 1)
        
        # –ü—Ä–∏—Ä–æ—Å—Ç –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
        growth_percent = ((income_august - income_july) / income_july * 100) if income_july > 0 else 0
        
        # –ü—Ä–∏—Ä–æ—Å—Ç –≤ —Ç—ã—Å. —Ä—É–±.
        growth_amount = income_august - income_july
        
        # –û–î –∫–æ–Ω–µ—Ü –∫–≤–∞—Ä—Ç–∞–ª–∞ = –∞–≤–≥—É—Å—Ç 2025
        od_quarter = income_august
        
        return {
            'operational_income_july': income_july,
            'operational_income_august': income_august,
            'growth_percent': round(growth_percent, 2),
            'growth_amount': growth_amount,
            'od_quarter': income_august
        }
    
    def create_sample_data(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
        self.start_time = time.time()
        
        try:
            self.logger.log_info(LOG_MESSAGES["data_generation_start"])
            
            # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–∫–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
            data1 = []  # –î–∞–Ω–Ω—ã–µ –Ω–∞ 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
            data2 = []  # –î–∞–Ω–Ω—ã–µ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞
            used_fios = set()
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–∞–∑–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–ª—è 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
            base_employees = []
            for i in range(DATA_PARAMS["total_employees"]):
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –§–ò–û
                while True:
                    fio = self._generate_fio()
                    if fio not in used_fios:
                        used_fios.add(fio)
                        break
                
                # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –¢–ë –∏ –ì–û–°–ë
                tb = np.random.choice(TERRITORIAL_BANKS)
                gosb = np.random.choice(self.tb_gosb_mapping[tb])
                
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
                tn = self._generate_tn()
                effective_status = self._generate_effective_status()
                
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–∞–∑–æ–≤—ã–π –¥–æ—Ö–æ–¥ (–∫–∞–∫ –±—ã –Ω–∞ –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞) –∏ –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è (—Ñ–∏–Ω–∞–ª—å–Ω—ã–π)
                # –ë–∞–∑–æ–≤—ã–π –¥–æ—Ö–æ–¥ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 60% –¥–æ 90% –æ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞
                base_income_min = int(DATA_PARAMS["operational_income_final_min"] * 0.6)
                base_income_max = int(DATA_PARAMS["operational_income_final_min"] * 0.9)
                base_income = np.random.randint(base_income_min, base_income_max + 1)
                income_july = np.random.randint(DATA_PARAMS["operational_income_final_min"], DATA_PARAMS["operational_income_final_max"] + 1)
                
                # –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–∏—Ä–æ—Å—Ç –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –¥–æ—Ö–æ–¥–∞ –¥–æ 31 –∏—é–ª—è (—Ñ–∏–Ω–∞–ª—å–Ω—ã–π)
                growth_percent_july = ((income_july - base_income) / base_income * 100) if base_income > 0 else 0
                growth_amount_july = income_july - base_income
                
                # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è 31 –∏—é–ª—è 2025 –≥–æ–¥–∞ (—Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥)
                row_july = {
                    '–¢–ù 10': tn,
                    '–¢–ë': tb,
                    '–ì–û–°–ë': gosb,
                    '–ö–ú': fio,
                    '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú': effective_status,
                    '2025, —Ç—ã—Å. —Ä—É–±.': income_july,
                    '2024, —Ç—ã—Å. —Ä—É–±. –Ω–∞ –∫–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞': base_income,
                    '–ü—Ä–∏—Ä–æ—Å—Ç, %': round(growth_percent_july, 2),
                    '–ü—Ä–∏—Ä–æ—Å—Ç, —Ç—ã—Å. —Ä—É–±.': growth_amount_july,
                    '–û–î –∫–æ–Ω–µ—Ü –∫–≤–∞—Ä—Ç–∞–ª–∞, —Ç—ã—Å. —Ä—É–±.': income_july
                }
                
                data1.append(row_july)
                base_employees.append({
                    'fio': fio,
                    'tn': tn,
                    'tb': tb,
                    'gosb': gosb,
                    'effective_status': effective_status,
                    'income_july': income_july
                })
                
                # –õ–æ–≥–∏—Ä—É–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 100 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
                if (i + 1) % 100 == 0:
                    self.logger.log_debug(LOG_MESSAGES["progress_employees"].format(i + 1))
            
            # –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è 20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞
            # 90% —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Å—Ç–∞—é—Ç—Å—è, 5% –Ω–æ–≤—ã—Ö, 5% —É–±–∏—Ä–∞–µ–º
            overlap_count = int(DATA_PARAMS["total_employees"] * DATA_PARAMS["employee_overlap"])
            new_count = int(DATA_PARAMS["total_employees"] * DATA_PARAMS["new_employees_share"])
            removed_count = DATA_PARAMS["total_employees"] - overlap_count - new_count
            
            # –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è (90%)
            remaining_employees = np.random.choice(base_employees, overlap_count, replace=False)
            
            # –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
            for emp in remaining_employees:
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–æ—Ö–æ–¥ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ (—Ç–µ–∫—É—â–∏–π, >= –¥–æ—Ö–æ–¥–∞ –Ω–∞ 31 –∏—é–ª—è)
                # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ = –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π = –∑–∞–¥–∞–Ω–Ω—ã–π –º–∞–∫—Å–∏–º—É–º
                income_august = np.random.randint(emp['income_july'], DATA_PARAMS["operational_income_current_max"] + 1)
                
                # –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–∏—Ä–æ—Å—Ç –æ—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –¥–æ 31 –∏—é–ª—è –¥–æ —Ç–µ–∫—É—â–µ–≥–æ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞
                growth_percent = ((income_august - emp['income_july']) / emp['income_july'] * 100) if emp['income_july'] > 0 else 0
                growth_amount = income_august - emp['income_july']
                
                row_august = {
                    '–¢–ù 10': emp['tn'],
                    '–¢–ë': emp['tb'],
                    '–ì–û–°–ë': emp['gosb'],
                    '–ö–ú': emp['fio'],
                    '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú': emp['effective_status'],
                    '2025, —Ç—ã—Å. —Ä—É–±.': income_august,
                    '2024, —Ç—ã—Å. —Ä—É–±. –Ω–∞ –∫–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞': emp['income_july'],
                    '–ü—Ä–∏—Ä–æ—Å—Ç, %': round(growth_percent, 2),
                    '–ü—Ä–∏—Ä–æ—Å—Ç, —Ç—ã—Å. —Ä—É–±.': growth_amount,
                    '–û–î –∫–æ–Ω–µ—Ü –∫–≤–∞—Ä—Ç–∞–ª–∞, —Ç—ã—Å. —Ä—É–±.': income_august
                }
                
                data2.append(row_august)
            
            # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (5%)
            for i in range(new_count):
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –§–ò–û
                while True:
                    fio = self._generate_fio()
                    if fio not in used_fios:
                        used_fios.add(fio)
                        break
                
                # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –¢–ë –∏ –ì–û–°–ë
                tb = np.random.choice(TERRITORIAL_BANKS)
                gosb = np.random.choice(self.tb_gosb_mapping[tb])
                
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                tn = self._generate_tn()
                effective_status = self._generate_effective_status()
                income_data = self._generate_operational_income_data()
                
                # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                row_august = {
                    '–¢–ù 10': tn,
                    '–¢–ë': tb,
                    '–ì–û–°–ë': gosb,
                    '–ö–ú': fio,
                    '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú': effective_status,
                    '2025, —Ç—ã—Å. —Ä—É–±.': income_data['operational_income_august'],
                    '2024, —Ç—ã—Å. —Ä—É–±. –Ω–∞ –∫–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞': income_data['operational_income_july'],
                    '–ü—Ä–∏—Ä–æ—Å—Ç, %': income_data['growth_percent'],
                    '–ü—Ä–∏—Ä–æ—Å—Ç, —Ç—ã—Å. —Ä—É–±.': income_data['growth_amount'],
                    '–û–î –∫–æ–Ω–µ—Ü –∫–≤–∞—Ä—Ç–∞–ª–∞, —Ç—ã—Å. —Ä—É–±.': income_data['od_quarter']
                }
                
                data2.append(row_august)
            
            # –°–æ–∑–¥–∞–µ–º DataFrame'—ã
            df1 = pd.DataFrame(data1)  # –î–∞–Ω–Ω—ã–µ –Ω–∞ 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
            df2 = pd.DataFrame(data2)  # –î–∞–Ω–Ω—ã–µ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞
            self.employees_created = len(df1) + len(df2)
            
            # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
            self._analyze_distribution(df1, df2)
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª—ã
            self._save_data_files(df1, df2)
            
            self.logger.log_info(LOG_MESSAGES["data_generation_end"])
            
        except Exception as e:
            error_msg = LOG_MESSAGES["generation_error"].format(str(e))
            self.logger.log_error(error_msg)
            self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
            self.errors_count += 1
        
        finally:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–≤–æ–¥–∫—É
            self._generate_summary()
    
    def _analyze_distribution(self, df1, df2):
        """–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–≤—É–º —Ñ–∞–π–ª–∞–º"""
        # –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ 1 (31 –∏—é–ª—è 2025 –≥–æ–¥–∞)
        self.logger.log_info(LOG_MESSAGES["analysis_file1"])
        tb_distribution_1 = df1['–¢–ë'].value_counts()
        self.logger.log_info(LOG_MESSAGES["tb_distribution"].format(dict(tb_distribution_1)))
        
        effective_distribution_1 = df1['–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú'].value_counts()
        self.logger.log_info(LOG_MESSAGES["effective_distribution"].format(dict(effective_distribution_1)))
        
        # –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ 2 (20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞)
        self.logger.log_info(LOG_MESSAGES["analysis_file2"])
        tb_distribution_2 = df2['–¢–ë'].value_counts()
        self.logger.log_info(LOG_MESSAGES["tb_distribution"].format(dict(tb_distribution_2)))
        
        effective_distribution_2 = df2['–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú'].value_counts()
        self.logger.log_info(LOG_MESSAGES["effective_distribution"].format(dict(effective_distribution_2)))
        
        # –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
        self.logger.log_info(LOG_MESSAGES["analysis_overlap"])
        employees_july = set(df1['–ö–ú'])
        employees_august = set(df2['–ö–ú'])
        
        overlap_employees = employees_july.intersection(employees_august)
        new_employees = employees_august - employees_july
        removed_employees = employees_july - employees_august
        
        self.logger.log_info(LOG_MESSAGES["employees_july_count"].format(len(employees_july)))
        self.logger.log_info(LOG_MESSAGES["employees_august_count"].format(len(employees_august)))
        self.logger.log_info(LOG_MESSAGES["overlap_info_detailed"].format(len(overlap_employees), len(overlap_employees)/len(employees_july)*100))
        self.logger.log_info(LOG_MESSAGES["new_employees_info_detailed"].format(len(new_employees), len(new_employees)/len(employees_august)*100))
        self.logger.log_info(LOG_MESSAGES["removed_employees_info_detailed"].format(len(removed_employees), len(removed_employees)/len(employees_july)*100))
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –¢–ù –∏ –§–ò–û –≤ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ
        unique_tn_1 = df1['–¢–ù 10'].nunique()
        unique_fio_1 = df1['–ö–ú'].nunique()
        unique_tn_2 = df2['–¢–ù 10'].nunique()
        unique_fio_2 = df2['–ö–ú'].nunique()
        
        self.logger.log_debug(LOG_MESSAGES["file1_info"].format(unique_tn_1, unique_fio_1))
        self.logger.log_debug(LOG_MESSAGES["file2_info"].format(unique_tn_2, unique_fio_2))
        
        if unique_tn_1 != len(df1):
            self.logger.log_error(LOG_MESSAGES["duplicate_tn_error"])
        if unique_fio_1 != len(df1):
            self.logger.log_error(LOG_MESSAGES["duplicate_fio_error"])
        if unique_tn_2 != len(df2):
            self.logger.log_error(LOG_MESSAGES["duplicate_tn_error"])
        if unique_fio_2 != len(df2):
            self.logger.log_error(LOG_MESSAGES["duplicate_tn_error"])
    
    def _save_data_files(self, df1, df2):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –¥–≤–∞ —Ñ–∞–π–ª–∞"""
        try:
            # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π
            timestamp = datetime.now().strftime("_%Y%m%d_%H%M%S")
            filename1 = f"data1{timestamp}.xlsx"  # –§–∞–π–ª –Ω–∞ 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
            filename2 = f"data2{timestamp}.xlsx"  # –§–∞–π–ª –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞
            
            file_path1 = self.work_dir / INPUT_FOLDER / filename1
            file_path2 = self.work_dir / INPUT_FOLDER / filename2
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª 1 (31 –∏—é–ª—è 2025 –≥–æ–¥–∞)
            df1.to_excel(file_path1, index=False, engine='openpyxl')
            self.logger.log_info(LOG_MESSAGES["test_file_created"].format(filename1))
            self.logger.log_debug(LOG_MESSAGES["file_saved_debug"].format(file_path1))
            self.logger.log_debug(LOG_MESSAGES["file_size_debug"].format(len(df1), len(df1.columns)))
            self.files_created += 1
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª 2 (20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞)
            df2.to_excel(file_path2, index=False, engine='openpyxl')
            self.logger.log_info(LOG_MESSAGES["test_file_created"].format(filename2))
            self.logger.log_debug(LOG_MESSAGES["file_saved_debug"].format(file_path2))
            self.logger.log_debug(LOG_MESSAGES["file_size_debug"].format(len(df2), len(df2.columns)))
            self.files_created += 1
            
        except Exception as e:
            error_msg = LOG_MESSAGES["save_error"].format(str(e))
            self.logger.log_error(error_msg)
            self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
            self.errors_count += 1
    
    def _generate_summary(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–≤–æ–¥–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
        end_time = time.time()
        execution_time = end_time - self.start_time
        
        summary = {
            'execution_time': format_execution_time(execution_time),
            'employees_created': self.employees_created,
            'files_created': self.files_created,
            'errors_count': self.errors_count
        }
        
        # –õ–æ–≥–∏—Ä—É–µ–º —Å–≤–æ–¥–∫—É
        self.logger.log_info(LOG_MESSAGES["summary"].format(summary))
        self.logger.log_info(LOG_MESSAGES["time_elapsed"].format(format_execution_time(execution_time)))
        self.logger.log_info(LOG_MESSAGES["employees_created"].format(self.employees_created))
        self.logger.log_info(LOG_MESSAGES["outputs_created"].format(self.files_created))
        self.logger.log_info(LOG_MESSAGES["errors_count"].format(self.errors_count))
        
        return summary

# =============================================================================
# –ö–õ–ê–°–° –î–õ–Ø –û–ë–†–ê–ë–û–¢–ö–ò –î–ê–ù–ù–´–•
# =============================================================================

class DataProcessor:
    """–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö"""
    
    def __init__(self, work_dir, logger):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
        
        Args:
            work_dir (str): –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
            logger (DataProcessorLogger): –û–±—ä–µ–∫—Ç –ª–æ–≥–≥–µ—Ä–∞
        """
        self.work_dir = Path(work_dir)
        self.logger = logger
        self.start_time = None
        self.errors_count = 0
        self.files_processed = 0
        self.outputs_created = 0
        
        # –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        self._create_directories()
    
    def _create_directories(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π"""
        directories = [
            self.work_dir / INPUT_FOLDER,
            self.work_dir / OUTPUT_FOLDER,
            self.work_dir / LOGS_FOLDER
        ]
        
        for directory in directories:
            directory.mkdir(parents=True, exist_ok=True)
            self.logger.log_debug(LOG_MESSAGES["directory_ready"].format(directory))
    
    def load_excel_files(self):
        """
        –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–æ–≤
        
        Returns:
            list: –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö DataFrame'–æ–≤
        """
        start_time = time.time()
        dataframes = []
        
        for file_config in INPUT_FILES:
            try:
                file_path = self.work_dir / INPUT_FOLDER / f"{file_config['name']}{file_config['extension']}"
                
                if file_path.exists():
                    # –ó–∞–≥—Ä—É–∂–∞–µ–º Excel —Ñ–∞–π–ª
                    df = pd.read_excel(file_path)
                    dataframes.append({
                        'name': file_config['name'],
                        'data': df,
                        'file_path': file_path
                    })
                    
                    self.logger.log_info(LOG_MESSAGES["file_loaded"].format(file_path.name))
                    self.logger.log_debug(LOG_MESSAGES["rows_columns_loaded"].format(len(df), len(df.columns), file_path.name))
                    self.files_processed += 1
                else:
                    self.logger.log_error(LOG_MESSAGES["file_not_found"].format(file_path))
                    self.errors_count += 1
                    
            except Exception as e:
                error_msg = LOG_MESSAGES["load_file_error"].format(file_config['name'], str(e))
                self.logger.log_error(error_msg)
                self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
                self.errors_count += 1
        
        end_time = time.time()
        execution_time = end_time - start_time
        self.logger.log_debug(LOG_MESSAGES["file_loading_time"].format(format_execution_time(execution_time)))
        
        return dataframes
    
    def process_data(self, dataframes):
        """
        –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –∏ —Ä–∞—Å—á–µ—Ç–æ–º –Ω–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
        
        Args:
            dataframes (list): –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö DataFrame'–æ–≤
            
        Returns:
            pd.DataFrame: –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        """
        start_time = time.time()
        self.logger.log_info(LOG_MESSAGES["processing_start"])
        
        if not dataframes:
            self.logger.log_error(LOG_MESSAGES["no_data_to_process"])
            return pd.DataFrame()
        
        try:
            # –ù–∞—Ö–æ–¥–∏–º —Ñ–∞–π–ª—ã data1 –∏ data2 –ø–æ –∏–º–µ–Ω–∞–º –∏–∑ INPUT_FILES
            df1 = None
            df2 = None
            
            # –ü–æ–ª—É—á–∞–µ–º –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
            file1_name = INPUT_FILES[0]['name']
            file2_name = INPUT_FILES[1]['name']
            
            for df_info in dataframes:
                if df_info['name'] == file1_name:
                    df1 = df_info['data']
                elif df_info['name'] == file2_name:
                    df2 = df_info['data']
            
            if df1 is None or df2 is None:
                self.logger.log_error(LOG_MESSAGES["files_not_found"].format(file1_name, file2_name))
                return pd.DataFrame()
            
            self.logger.log_debug(LOG_MESSAGES["files_loaded_info"].format(len(df1), len(df2)))
            
            # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¢–ù 10, –¢–ë, –ì–û–°–ë, –§–ò–û
            # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¢–ù –∏–∑ –æ–±–æ–∏—Ö —Ñ–∞–π–ª–æ–≤
            all_tn = pd.concat([
                df1[['–¢–ù 10', '–¢–ë', '–ì–û–°–ë', '–ö–ú']].drop_duplicates(),
                df2[['–¢–ù 10', '–¢–ë', '–ì–û–°–ë', '–ö–ú']].drop_duplicates()
            ]).drop_duplicates(subset=['–¢–ù 10'], keep='last')
            
            self.logger.log_debug(LOG_MESSAGES["unique_tn_list_created"].format(len(all_tn)))
            
            # –°–æ–∑–¥–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π DataFrame
            result_data = []
            
            for _, row in all_tn.iterrows():
                tn = row['–¢–ù 10']
                tb = row['–¢–ë']
                gosb = row['–ì–û–°–ë']
                fio = row['–ö–ú']
                
                # –ò—â–µ–º –¥–∞–Ω–Ω—ã–µ –≤ DataFrame
                data1_row = df1[df1['–¢–ù 10'] == tn]
                data2_row = df2[df2['–¢–ù 10'] == tn]
                
                # –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞ 1
                od_current = data1_row['2025, —Ç—ã—Å. —Ä—É–±.'].iloc[0] if len(data1_row) > 0 else 0
                od_previous = data1_row['2024, —Ç—ã—Å. —Ä—É–±. –Ω–∞ –∫–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞'].iloc[0] if len(data1_row) > 0 else 0
                
                # –ü–æ–ª—É—á–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–∑ —Ñ–∞–π–ª–∞ 2, –µ—Å–ª–∏ –Ω–µ—Ç - –∏–∑ —Ñ–∞–π–ª–∞ 1
                if len(data2_row) > 0:
                    effectiveness = data2_row['–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú'].iloc[0]
                elif len(data1_row) > 0:
                    effectiveness = data1_row['–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú'].iloc[0]
                else:
                    effectiveness = "üëé"
                
                # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                effectiveness_num = 1 if effectiveness == "üëç" else 0
                
                # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–µ–º–ø –û–î
                if od_previous == 0:
                    if od_current > 0:
                        temp_od = 100
                    elif od_current < 0:
                        temp_od = -100
                    else:
                        temp_od = 0
                else:
                    temp_od = (od_current - od_previous) / abs(od_previous) * 100
                
                # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                result_row = {
                    '–¢–ù 10': tn,
                    '–¢–ë': tb,
                    '–ì–û–°–ë': gosb,
                    '–§–ò–û': fio,
                    '–≠–§.–ö–ú': effectiveness_num,
                    '–û–î –¢–ï–ö–£–©–ò–ô': od_current,
                    '—Ä–∞–Ω–≥ –û–î BANK': 0,  # –ë—É–¥–µ—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–æ –ø–æ–∑–∂–µ
                    '—Ä–∞–Ω–≥ –û–î TB': 0,    # –ë—É–¥–µ—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–æ –ø–æ–∑–∂–µ
                    '–û–î –ü–†–û–®–õ–´–ô': od_previous,
                    '–ø—Ä–∏—Ä–æ—Å—Ç': od_current - od_previous,
                    '—Ç–µ–º–ø': round(temp_od, 2),
                    '–≤—ã–ø —É—Å–ª–æ–≤–∏–π': 1 if (od_current - od_previous) > 0 else 0,
                    '–°–¢–†–ê–ù–ê 50': 0,  # –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏
                    '–°–¢–†–ê–ù–ê 75': 0,  # –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏
                    '–°–¢–†–ê–ù–ê 90': 0,  # –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏
                    '–¢–ë 25': 0,      # –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏
                    '–¢–ë 50': 0,      # –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏
                    '–¢–ë 75': 0,      # –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏
                    '–ì–û–°–ë 25': 0,    # –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏
                    '–ì–û–°–ë 50': 0,    # –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏
                    '–ì–û–°–ë 75': 0,    # –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏
                    '–ö–û–î –≤—ã–≤–æ–¥–∞': 0,  # –ë—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ –ø–æ–∑–∂–µ
                    '—á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∞': 0,  # –ë—É–¥–µ—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–æ –ø–æ–∑–∂–µ
                    '—á–∏—Å–ª–æ –¢–ë': 0,      # –ë—É–¥–µ—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–æ –ø–æ–∑–∂–µ
                    '—á–∏—Å–ª–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ': 0,  # –ë—É–¥–µ—Ç –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–æ –ø–æ–∑–∂–µ
                    '–≤—ã–≤–æ–¥': '',       # –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–∑–∂–µ
                }
                
                result_data.append(result_row)
            
            # –°–æ–∑–¥–∞–µ–º DataFrame
            result_df = pd.DataFrame(result_data)
            
            # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–Ω–≥–∏ –û–î
            self.logger.log_debug("–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–Ω–≥–∏ –û–î...")
            
            # –†–ê–ù–ì –û–î –î–õ–Ø –£–†–û–í–ù–Ø BANK - —Ç–æ—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Excel —Ñ–æ—Ä–º—É–ª—ã
            # =–°–ß–Å–¢–ï–°–õ–ò–ú–ù(–ö–ú–†[–û–î –¢–ï–ö–£–©–ò–ô];"<"&–ö–ú–†[[#–≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞];[–û–î –¢–ï–ö–£–©–ò–ô]])/–°–ß–Å–¢(–ö–ú–†[–û–î –¢–ï–ö–£–©–ò–ô])
            result_df['—Ä–∞–Ω–≥ –û–î BANK'] = result_df['–û–î –¢–ï–ö–£–©–ò–ô'].apply(
                lambda x: (result_df['–û–î –¢–ï–ö–£–©–ò–ô'] < x).sum() / len(result_df) * 100
            ).round(2)
            
            # –†–ê–ù–ì –û–î –î–õ–Ø –£–†–û–í–ù–Ø TB - —Ç–æ—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Excel —Ñ–æ—Ä–º—É–ª—ã
            # =–°–ß–Å–¢–ï–°–õ–ò–ú–ù(–ö–ú–†[–û–î –¢–ï–ö–£–©–ò–ô];"<"&–ö–ú–†[[#–≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞];[–û–î –¢–ï–ö–£–©–ò–ô]];–ö–ú–†[–¢–ë];–ö–ú–†[[#–≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞];[–¢–ë]])/–°–ß–Å–¢–ï–°–õ–ò–ú–ù(–ö–ú–†[–¢–ë];–ö–ú–†[[#–≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞];[–¢–ë]])
            result_df['—Ä–∞–Ω–≥ –û–î TB'] = result_df.apply(
                lambda row: (
                    (result_df[result_df['–¢–ë'] == row['–¢–ë']]['–û–î –¢–ï–ö–£–©–ò–ô'] < row['–û–î –¢–ï–ö–£–©–ò–ô']).sum() /
                    len(result_df[result_df['–¢–ë'] == row['–¢–ë']]) * 100
                ) if len(result_df[result_df['–¢–ë'] == row['–¢–ë']]) > 0 else 0, axis=1
            ).round(2)
            
            # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏ –¥–ª—è —Ç—Ä–µ—Ö —É—Ä–æ–≤–Ω–µ–π
            self.logger.log_debug("–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏...")
            
            # –ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏ –¥–ª—è —É—Ä–æ–≤–Ω—è –ë–ê–ù–ö (–ø–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º)
            bank_percentiles = result_df['–û–î –¢–ï–ö–£–©–ò–ô'].quantile([p/100 for p in PERCENTILES])
            
            # –ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏ –¥–ª—è —É—Ä–æ–≤–Ω—è –¢–ë (–ø–æ –∫–∞–∂–¥–æ–º—É –¢–ë –æ—Ç–¥–µ–ª—å–Ω–æ)
            tb_percentiles = {}
            for tb in result_df['–¢–ë'].unique():
                tb_mask = result_df['–¢–ë'] == tb
                tb_percentiles[tb] = result_df.loc[tb_mask, '–û–î –¢–ï–ö–£–©–ò–ô'].quantile([p/100 for p in PERCENTILES])
            
            # –ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏ –¥–ª—è —É—Ä–æ–≤–Ω—è –ì–û–°–ë (–ø–æ –∫–∞–∂–¥–æ–º—É –ì–û–°–ë –æ—Ç–¥–µ–ª—å–Ω–æ)
            gosb_percentiles = {}
            for gosb in result_df['–ì–û–°–ë'].unique():
                gosb_mask = result_df['–ì–û–°–ë'] == gosb
                gosb_percentiles[gosb] = result_df.loc[gosb_mask, '–û–î –¢–ï–ö–£–©–ò–ô'].quantile([p/100 for p in PERCENTILES])
            
            # –ó–∞–ø–æ–ª–Ω—è–µ–º –∫–æ–ª–æ–Ω–∫–∏ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º–∏
            result_df['–°–¢–†–ê–ù–ê 50'] = bank_percentiles[0.50]
            result_df['–°–¢–†–ê–ù–ê 75'] = bank_percentiles[0.75]
            result_df['–°–¢–†–ê–ù–ê 90'] = bank_percentiles[0.90] if 0.90 in bank_percentiles.index else bank_percentiles[0.75]
            
            # –ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏ –¢–ë –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏
            result_df['–¢–ë 25'] = result_df['–¢–ë'].map(lambda x: tb_percentiles[x][0.25])
            result_df['–¢–ë 50'] = result_df['–¢–ë'].map(lambda x: tb_percentiles[x][0.50])
            result_df['–¢–ë 75'] = result_df['–¢–ë'].map(lambda x: tb_percentiles[x][0.75])
            
            # –ü—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏ –ì–û–°–ë –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏
            result_df['–ì–û–°–ë 25'] = result_df['–ì–û–°–ë'].map(lambda x: gosb_percentiles[x][0.25])
            result_df['–ì–û–°–ë 50'] = result_df['–ì–û–°–ë'].map(lambda x: gosb_percentiles[x][0.50])
            result_df['–ì–û–°–ë 75'] = result_df['–ì–û–°–ë'].map(lambda x: gosb_percentiles[x][0.75])
            
            # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ "—á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∞", "—á–∏—Å–ª–æ –¢–ë", "—á–∏—Å–ª–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ"
            self.logger.log_debug("–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—è–º...")
            
            # —á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∞ - —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ç–µ–º–ø—É —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö
            result_df['—á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∞'] = result_df['—Ç–µ–º–ø'].rank(method='min', ascending=False)
            
            # —á–∏—Å–ª–æ –¢–ë - —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ç–µ–º–ø—É –≤ —Ä–∞–º–∫–∞—Ö –¢–ë
            result_df['—á–∏—Å–ª–æ –¢–ë'] = result_df.groupby('–¢–ë')['—Ç–µ–º–ø'].rank(method='min', ascending=False)
            
            # —á–∏—Å–ª–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ - —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ç–µ–º–ø—É –≤ —Ä–∞–º–∫–∞—Ö –ì–û–°–ë
            result_df['—á–∏—Å–ª–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ'] = result_df.groupby('–ì–û–°–ë')['—Ç–µ–º–ø'].rank(method='min', ascending=False)
            
            # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫—É "–ö–û–î –≤—ã–≤–æ–¥–∞" —Å–æ–≥–ª–∞—Å–Ω–æ –ª–æ–≥–∏–∫–µ –∏–∑ Excel —Ñ–∞–π–ª–∞
            def calculate_kod_vyvoda(row):
                """
                –†–∞—Å—á–µ—Ç –∫–æ–¥–∞ –≤—ã–≤–æ–¥–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –ª–æ–≥–∏–∫–µ –∏–∑ –ª–∏—Å—Ç–∞ 't' Excel —Ñ–∞–π–ª–∞:
                - –ö–æ–¥ 6: –≤—ã—à–µ, —á–µ–º —É 90% –ö–ú –≤ —Å—Ç—Ä–∞–Ω–µ
                - –ö–æ–¥ 5: –≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ —Å—Ç—Ä–∞–Ω–µ  
                - –ö–æ–¥ 4: –≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ —Ç–µ—Ä–±–∞–Ω–∫–µ (—Å—Ä–µ–¥–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö)
                - –ö–æ–¥ 3: –≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ —Ç–µ—Ä–±–∞–Ω–∫–µ (—Å—Ä–µ–¥–∏ –≤—Å–µ—Ö)
                - –ö–æ–¥ 2: –≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ –ì–û–°–ë/–∞–ø–ø–∞—Ä–∞—Ç–µ (—Å—Ä–µ–¥–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç)
                - –ö–æ–¥ 1: –Ω–∏–∂–µ, —á–µ–º —É 75% –ö–ú –≤ –ì–û–°–ë/–∞–ø–ø–∞—Ä–∞—Ç–µ (—Å—Ä–µ–¥–∏ –≤—Å–µ—Ö, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç)
                """
                # –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
                number_strana = row['—á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∞']
                number_tb = row['—á–∏—Å–ª–æ –¢–ë']
                number_gosb = row['—á–∏—Å–ª–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ']
                effectiveness = row['–≠–§.–ö–ú']  # 1 –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö, 0 –¥–ª—è –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö
                prir = row['–ø—Ä–∏—Ä–æ—Å—Ç']  # –ø—Ä–∏—Ä–æ—Å—Ç –û–î
                
                # –ö–æ–¥ 6: –≤—ã—à–µ, —á–µ–º —É 90% –ö–ú –≤ —Å—Ç—Ä–∞–Ω–µ
                if number_strana <= 0.1 * len(result_df):  # –¢–æ–ø-10% –ø–æ —Å—Ç—Ä–∞–Ω–µ
                    return 6
                
                # –ö–æ–¥ 5: –≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ —Å—Ç—Ä–∞–Ω–µ
                elif number_strana <= 0.25 * len(result_df):  # –¢–æ–ø-25% –ø–æ —Å—Ç—Ä–∞–Ω–µ
                    return 5
                
                # –ö–æ–¥ 4: –≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ —Ç–µ—Ä–±–∞–Ω–∫–µ (—Å—Ä–µ–¥–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö)
                elif effectiveness == 1 and number_tb <= 0.25 * len(result_df[result_df['–¢–ë'] == row['–¢–ë']]):
                    return 4
                
                # –ö–æ–¥ 3: –≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ —Ç–µ—Ä–±–∞–Ω–∫–µ (—Å—Ä–µ–¥–∏ –≤—Å–µ—Ö)
                elif number_tb <= 0.25 * len(result_df[result_df['–¢–ë'] == row['–¢–ë']]):
                    return 3
                
                # –ö–æ–¥ 2: –≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ –ì–û–°–ë/–∞–ø–ø–∞—Ä–∞—Ç–µ (—Å—Ä–µ–¥–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç)
                elif effectiveness == 1 and prir > 0 and number_gosb <= 0.25 * len(result_df[result_df['–ì–û–°–ë'] == row['–ì–û–°–ë']]):
                    return 2
                
                # –ö–æ–¥ 1: –Ω–∏–∂–µ, —á–µ–º —É 75% –ö–ú –≤ –ì–û–°–ë/–∞–ø–ø–∞—Ä–∞—Ç–µ (—Å—Ä–µ–¥–∏ –≤—Å–µ—Ö, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç)
                elif prir > 0 and number_gosb <= 0.25 * len(result_df[result_df['–ì–û–°–ë'] == row['–ì–û–°–ë']]):
                    return 1
                
                # –ï—Å–ª–∏ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –Ω–∏ –ø–æ–¥ –æ–¥–∏–Ω –∫–æ–¥
                else:
                    return 0
            
            result_df['–ö–û–î –≤—ã–≤–æ–¥–∞'] = result_df.apply(calculate_kod_vyvoda, axis=1)
            
            # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫—É "–≤—ã–≤–æ–¥" –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–∞ –≤—ã–≤–æ–¥–∞
            def calculate_output_by_code(row):
                """
                –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –∫–æ–¥—É –≤—ã–≤–æ–¥–∞
                """
                kod = row['–ö–û–î –≤—ã–≤–æ–¥–∞']
                
                if kod == 6:
                    return "–≤—ã—à–µ, —á–µ–º —É 90% –ö–ú –≤ —Å—Ç—Ä–∞–Ω–µ"
                elif kod == 5:
                    return "–≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ —Å—Ç—Ä–∞–Ω–µ"
                elif kod == 4:
                    return "–≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ —Ç–µ—Ä–±–∞–Ω–∫–µ (—Å—Ä–µ–¥–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö)"
                elif kod == 3:
                    return "–≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ —Ç–µ—Ä–±–∞–Ω–∫–µ"
                elif kod == 2:
                    return "–≤—ã—à–µ, —á–µ–º —É 75% –ö–ú –≤ –ì–û–°–ë/–∞–ø–ø–∞—Ä–∞—Ç–µ (—Å—Ä–µ–¥–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö)"
                elif kod == 1:
                    return "–Ω–∏–∂–µ, —á–µ–º —É 75% –ö–ú –≤ –ì–û–°–ë/–∞–ø–ø–∞—Ä–∞—Ç–µ"
                else:
                    return "–æ–±—ã—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç"
            
            result_df['–≤—ã–≤–æ–¥'] = result_df.apply(calculate_output_by_code, axis=1)
            
            end_time = time.time()
            execution_time = end_time - start_time
            self.logger.log_debug(LOG_MESSAGES["data_processing_time"].format(format_execution_time(execution_time)))
            self.logger.log_debug(LOG_MESSAGES["data_processed_info"].format(len(result_df), len(result_df.columns)))
            self.logger.log_info(LOG_MESSAGES["processing_end"])
            
            return result_df
            
        except Exception as e:
            error_msg = LOG_MESSAGES["processing_error"].format(str(e))
            self.logger.log_error(error_msg)
            self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
            self.errors_count += 1
            return pd.DataFrame()
    
    def save_outputs(self, processed_data):
        """
        –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
        
        Args:
            processed_data (pd.DataFrame): –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        """
        start_time = time.time()
        if processed_data.empty:
            self.logger.log_error(LOG_MESSAGES["no_data_to_save"])
            return
        
        for output_config in OUTPUT_FILES:
            try:
                # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º—è —Ñ–∞–π–ª–∞ —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º
                timestamp = datetime.now().strftime(
                    output_config["suffix_format"]
                    .replace("YYYY", "%Y")
                    .replace("MM", "%m")
                    .replace("DD", "%d")
                    .replace("HH", "%H")
                    .replace("MM", "%M")
                    .replace("SS", "%S")
                )
                
                filename = f"{output_config['name']}{timestamp}{output_config['extension']}"
                file_path = self.work_dir / OUTPUT_FOLDER / filename
                
                # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–æ—Ä–º–∞—Ç–∞
                # –ó–ê–ö–õ–ê–î–ö–ê –î–õ–Ø –ë–£–î–£–©–ï–ì–û CSV:
                # if output_config['extension'].lower() == '.csv':
                #     # –°–æ—Ö—Ä–∞–Ω—è–µ–º CSV —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º ";"
                #     processed_data.to_csv(file_path, sep=';', index=False, encoding='utf-8')
                # if output_config['extension'].lower() == '.xlsx':
                # 
                # –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è - —Ç–æ–ª—å–∫–æ Excel —Ñ–∞–π–ª
                if output_config['extension'].lower() == '.xlsx':
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º Excel —Å –∞–≤—Ç–æ—Ñ–∏–ª—å—Ç—Ä–æ–º –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
                    processed_data.to_excel(file_path, index=False, engine='openpyxl')
                    
                    # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ñ–∏–ª—å—Ç—Ä–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                    
                    # –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
                    wb = load_workbook(file_path)
                    ws = wb.active
                    
                    # –î–æ–±–∞–≤–ª—è–µ–º –∞–≤—Ç–æ—Ñ–∏–ª—å—Ç—Ä –Ω–∞—á–∏–Ω–∞—è —Å –∫–æ–ª–æ–Ω–∫–∏ E (5-—è –∫–æ–ª–æ–Ω–∫–∞) –∏ —Å—Ç—Ä–æ–∫–∏ 2
                    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è –∞–≤—Ç–æ—Ñ–∏–ª—å—Ç—Ä–∞ (–≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
                    max_row = len(processed_data) + 1  # +1 –ø–æ—Ç–æ–º—É —á—Ç–æ pandas.to_excel –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏
                    max_col = len(processed_data.columns)
                    
                    # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±—É–∫–≤—ã –∫–æ–ª–æ–Ω–∫–∏ –ø–æ –Ω–æ–º–µ—Ä—É
                    def get_column_letter(col_num):
                        """–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –Ω–æ–º–µ—Ä –∫–æ–ª–æ–Ω–∫–∏ –≤ –±—É–∫–≤—É Excel (A, B, C, ..., Z, AA, AB, ...)"""
                        result = ""
                        while col_num > 0:
                            col_num, remainder = divmod(col_num - 1, 26)
                            result = chr(65 + remainder) + result
                        return result
                    
                    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–≤—Ç–æ—Ñ–∏–ª—å—Ç—Ä –Ω–∞ –¥–∏–∞–ø–∞–∑–æ–Ω A1:–ø–æ—Å–ª–µ–¥–Ω—è—è_–∫–æ–ª–æ–Ω–∫–∞_–ø–æ—Å–ª–µ–¥–Ω—è—è_—Å—Ç—Ä–æ–∫–∞ (–∑–∞–≥–æ–ª–æ–≤–∫–∏ + –¥–∞–Ω–Ω—ã–µ)
                    # A1 = –∑–∞–≥–æ–ª–æ–≤–∫–∏, A2:–ø–æ—Å–ª–µ–¥–Ω—è—è_–∫–æ–ª–æ–Ω–∫–∞_–ø–æ—Å–ª–µ–¥–Ω—è—è_—Å—Ç—Ä–æ–∫–∞ = –¥–∞–Ω–Ω—ã–µ
                    last_col_letter = get_column_letter(max_col)
                    ws.auto_filter.ref = f"A1:{last_col_letter}{max_row}"
                    
                    # –§–∏–∫—Å–∏—Ä—É–µ–º –ø–∞–Ω–µ–ª–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ A2 (–∫–æ–ª–æ–Ω–∫–∞ A, —Å—Ç—Ä–æ–∫–∞ 2) - –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤–∏–¥–∏–º—ã–º–∏
                    ws.freeze_panes = "A2"
                    
                    # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–∫–∏
                    def get_column_format_config(column_name):
                        """–ü–æ–ª—É—á–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∫–æ–ª–æ–Ω–∫–∏ –∏–∑ –≥—Ä—É–ø–ø –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫"""
                        # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≥—Ä—É–ø–ø–æ–≤—ã–µ)
                        if column_name in COLUMN_SPECIAL_FORMATS:
                            special_config = COLUMN_SPECIAL_FORMATS[column_name].copy()
                            
                            # –ò—â–µ–º –≥—Ä—É–ø–ø—É –¥–ª—è —ç—Ç–æ–π –∫–æ–ª–æ–Ω–∫–∏
                            for group_name, group_config in COLUMN_FORMAT_GROUPS.items():
                                if column_name in group_config['columns']:
                                    # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≥—Ä—É–ø–ø–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º–∏
                                    format_config = group_config.copy()
                                    format_config.update(special_config)  # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≥—Ä—É–ø–ø–æ–≤—ã–µ
                                    return format_config
                            
                            # –ï—Å–ª–∏ –∫–æ–ª–æ–Ω–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –≥—Ä—É–ø–ø–∞—Ö, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ
                            return special_config
                        
                        # –ï—Å–ª–∏ –Ω–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫, –∏—â–µ–º –≤ –≥—Ä—É–ø–ø–∞—Ö
                        for group_name, group_config in COLUMN_FORMAT_GROUPS.items():
                            if column_name in group_config['columns']:
                                return group_config.copy()
                        
                        # –ï—Å–ª–∏ –∫–æ–ª–æ–Ω–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –Ω–∏–≥–¥–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º None
                        return None
                    
                    # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ —Å–æ–≥–ª–∞—Å–Ω–æ –≥—Ä—É–ø–ø–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
                    for col in range(1, max_col + 1):
                        column_letter = get_column_letter(col)
                        column_name = processed_data.columns[col - 1]  # –ü–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏
                        
                        # –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∫–æ–ª–æ–Ω–∫–∏
                        format_config = get_column_format_config(column_name)
                        
                        if format_config:
                            # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∏—Ä–∏–Ω—É –∫–æ–ª–æ–Ω–∫–∏
                            ws.column_dimensions[column_letter].width = format_config.get('width', 15)
                            
                            # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ –≤—Å–µ–º —è—á–µ–π–∫–∞–º –≤ –∫–æ–ª–æ–Ω–∫–µ (–∫—Ä–æ–º–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
                            for row in range(2, max_row + 1):  # –ù–∞—á–∏–Ω–∞–µ–º —Å–æ 2-–π —Å—Ç—Ä–æ–∫–∏ (–ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞)
                                cell = ws[f"{column_letter}{row}"]
                                
                                # –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è padded_number
                                if format_config.get('format_type') == 'padded_number':
                                    # –î–ª—è —á–∏—Å–µ–ª —Å –ª–∏–¥–∏—Ä—É—é—â–∏–º–∏ –Ω—É–ª—è–º–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
                                    cell.number_format = '@'  # –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç Excel
                                    # –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –ª–µ–≤–æ–º—É –∫—Ä–∞—é –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
                                    cell.alignment = Alignment(horizontal='left', vertical='center')
                                else:
                                    # –ü—Ä–∏–º–µ–Ω—è–µ–º —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç
                                    if format_config.get('format') == 'number' and 'number_format' in format_config:
                                        cell.number_format = format_config['number_format']
                                    
                                    # –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ
                                    alignment = format_config.get('alignment', 'left')
                                    if alignment == 'center':
                                        cell.alignment = Alignment(horizontal='center', vertical='center')
                                    elif alignment == 'right':
                                        cell.alignment = Alignment(horizontal='right', vertical='center')
                                    elif alignment == 'left':
                                        cell.alignment = Alignment(horizontal='left', vertical='center')
                        else:
                            # –î–ª—è –∫–æ–ª–æ–Ω–æ–∫ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ - —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
                            max_width = 0
                            for row in range(1, max_row + 1):
                                cell_value = ws[f"{column_letter}{row}"].value
                                if cell_value is not None:
                                    if isinstance(cell_value, (int, float)):
                                        width = len(str(cell_value)) + 2
                                    else:
                                        width = len(str(cell_value)) + 1
                                    max_width = max(max_width, width)
                            
                            ws.column_dimensions[column_letter].width = min(max_width + 2, 50)
                    
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                    wb.save(file_path)
                    wb.close()
                    
                    self.logger.log_debug(LOG_MESSAGES["autofilter_added"].format(f"A1:{last_col_letter}{max_row}"))
                    self.logger.log_debug(LOG_MESSAGES["panes_frozen"])
                    # –õ–æ–≥–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
                    formatted_columns = 0
                    for group_name, group_config in COLUMN_FORMAT_GROUPS.items():
                        formatted_columns += len(group_config['columns'])
                    
                    # –õ–æ–≥–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
                    formatted_columns = 0
                    for group_name, group_config in COLUMN_FORMAT_GROUPS.items():
                        formatted_columns += len(group_config['columns'])
                    
                    # –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ —Å–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
                    special_formatted = 0
                    for col_name, col_config in COLUMN_SPECIAL_FORMATS.items():
                        if col_config.get('format_type') == 'padded_number':
                            special_formatted += 1
                    
                    self.logger.log_debug(LOG_MESSAGES["group_formatting_applied"].format(len(COLUMN_FORMAT_GROUPS), formatted_columns))
                    self.logger.log_debug(LOG_MESSAGES["special_formats_applied"].format(len(COLUMN_SPECIAL_FORMATS)))
                    if special_formatted > 0:
                        self.logger.log_debug(LOG_MESSAGES["padded_number_formatted"].format(special_formatted))
                
                self.logger.log_info(LOG_MESSAGES["file_saved"].format(filename))
                self.logger.log_debug(LOG_MESSAGES["file_saved_debug_old"].format(file_path))
                self.outputs_created += 1
                
            except Exception as e:
                error_msg = LOG_MESSAGES["save_error"].format(f"{output_config['name']}: {str(e)}")
                self.logger.log_error(error_msg)
                self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
                self.errors_count += 1
        
        end_time = time.time()
        execution_time = end_time - start_time
        self.logger.log_debug(LOG_MESSAGES["file_saving_time"].format(format_execution_time(execution_time)))
    
    def generate_summary(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–≤–æ–¥–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
        end_time = time.time()
        execution_time = end_time - self.start_time
        
        summary = {
            'execution_time': format_execution_time(execution_time),
            'files_processed': self.files_processed,
            'outputs_created': self.outputs_created,
            'errors_count': self.errors_count
        }
        
        # –õ–æ–≥–∏—Ä—É–µ–º —Å–≤–æ–¥–∫—É
        self.logger.log_info(LOG_MESSAGES["summary"].format(summary))
        self.logger.log_info(LOG_MESSAGES["time_elapsed"].format(format_execution_time(execution_time)))
        self.logger.log_info(LOG_MESSAGES["files_processed"].format(self.files_processed))
        self.logger.log_info(LOG_MESSAGES["outputs_created"].format(self.outputs_created))
        self.logger.log_info(LOG_MESSAGES["errors_count"].format(self.errors_count))
        
        return summary
    
    def run(self):
        """–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –∑–∞–ø—É—Å–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö"""
        self.start_time = time.time()
        
        try:
            # –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            dataframes = self.load_excel_files()
            
            # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            processed_data = self.process_data(dataframes)
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            self.save_outputs(processed_data)
            
        except Exception as e:
            error_msg = LOG_MESSAGES["processing_error"].format(str(e))
            self.logger.log_error(error_msg)
            self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
            self.errors_count += 1
        
        finally:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–≤–æ–¥–∫—É
            self.generate_summary()

# =============================================================================
# –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
# =============================================================================

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
    
    try:
        # –°–æ–∑–¥–∞–µ–º –ª–æ–≥–≥–µ—Ä
        logger = DataProcessorLogger(
            log_dir=Path(WORK_DIR) / LOGS_FOLDER,
            log_name=LOG_FILE["name"],
            log_extension=LOG_FILE["extension"],
            suffix_format=LOG_FILE["suffix_format"],
            level=LOG_LEVEL
        )
        
        # –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
        logger.log_start()
        
        if PROGRAM_MODE == 'create-test':
            # –†–µ–∂–∏–º —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            logger.log_info(LOG_MESSAGES["mode_create_test"])
            generator = TestDataGenerator(WORK_DIR, logger)
            generator.create_sample_data()
            print(LOG_MESSAGES["test_data_success"])
            
        else:
            # –†–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
            logger.log_info(LOG_MESSAGES["mode_process"])
            processor = DataProcessor(WORK_DIR, logger)
            processor.run()
            print(LOG_MESSAGES["process_success"])
        
        # –õ–æ–≥–∏—Ä—É–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
        logger.log_end()
        
    except Exception as e:
        print(LOG_MESSAGES["main_critical_error"].format(str(e)))
        sys.exit(1)

# =============================================================================
# –¢–û–ß–ö–ê –í–•–û–î–ê
# =============================================================================

if __name__ == "__main__":
    main()
