#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–æ–≤
–ê–≤—Ç–æ—Ä: AI Assistant
–í–µ—Ä—Å–∏—è: 1.0.0
–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 2024
"""

import os
import sys
import time
import logging
import pandas as pd
import numpy as np
from datetime import datetime
from pathlib import Path
import traceback

# =============================================================================
# –ö–û–ù–°–¢–ê–ù–¢–´ –ò –ù–ê–°–¢–†–û–ô–ö–ò –ü–†–û–ì–†–ê–ú–ú–´
# =============================================================================

# –ü—É—Ç—å –∫ —Ä–∞–±–æ—á–µ–π –ø–∞–ø–∫–µ (—Å—ã—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)
WORK_DIR = r"/Users/orionflash/Desktop/MyProject/Reaction_Effectiv_LOAD/WORK"

# –ù–∞–∑–≤–∞–Ω–∏—è –ø–æ–¥–ø–∞–ø–æ–∫
INPUT_FOLDER = "INPUT"      # –ü–∞–ø–∫–∞ —Å –≤—Ö–æ–¥–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
OUTPUT_FOLDER = "OUTPUT"    # –ü–∞–ø–∫–∞ —Å –≤—ã—Ö–æ–¥–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
LOGS_FOLDER = "LOGS"        # –ü–∞–ø–∫–∞ —Å –ª–æ–≥–∞–º–∏

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (–∏–º—è –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ)
INPUT_FILES = [
    {"name": "data1_20250821_144017", "extension": ".xlsx"},
    {"name": "data2_20250821_144017", "extension": ".xlsx"}
]

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
OUTPUT_FILES = [
    {"name": "processed_data", "extension": ".csv", "suffix_format": "_YYYYMMDD-HHMMSS"},
    {"name": "processed_data", "extension": ".xlsx", "suffix_format": "_YYYYMMDD-HHMMSS"}
]

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥-—Ñ–∞–π–ª–∞
LOG_FILE = {
    "name": "processing_log",
    "extension": ".log",
    "suffix_format": "_YYYYMMDD"
}

# –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã
# "process" - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–æ—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞)
# "create-test" - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
PROGRAM_MODE = "process"

# –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (INFO –∏–ª–∏ DEBUG)
LOG_LEVEL = "DEBUG"

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
DATA_PARAMS = {
    "total_employees": 1600,        # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
    "effective_share": 0.80,        # –î–æ–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (80%)
    "operational_income_july_min": 500000,    # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è 2025 (—Ç—ã—Å. —Ä—É–±.)
    "operational_income_july_max": 20000000,   # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è 2025 (—Ç—ã—Å. —Ä—É–±.)
    "operational_income_august_min": 500000,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 (—Ç—ã—Å. —Ä—É–±.)
    "operational_income_august_max": 220000000, # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 (—Ç—ã—Å. —Ä—É–±.)
    "employee_overlap": 0.90,       # –î–æ–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –¥–≤—É—Ö —Ñ–∞–π–ª–∞—Ö (90%)
    "new_employees_share": 0.05,    # –î–æ–ª—è –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (5%)
    "removed_employees_share": 0.05 # –î–æ–ª—è —É–±—Ä–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (5%)
}

# –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∞–ª—å–Ω—ã–µ –±–∞–Ω–∫–∏ (–¢–ë)
TERRITORIAL_BANKS = [
    "–ë–∞–π–∫–∞–ª—å—Å–∫–∏–π –±–∞–Ω–∫",
    "–í–æ–ª–≥–æ-–í—è—Ç—Å–∫–∏–π –±–∞–Ω–∫",
    "–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–π –±–∞–Ω–∫",
    "–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –±–∞–Ω–∫",
    "–ü–æ–≤–æ–ª–∂—Å–∫–∏–π –±–∞–Ω–∫",
    "–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –±–∞–Ω–∫",
    "–°–∏–±–∏—Ä—Å–∫–∏–π –±–∞–Ω–∫",
    "–°—Ä–µ–¥–Ω–µ—Ä—É—Å—Å–∫–∏–π –±–∞–Ω–∫",
    "–£—Ä–∞–ª—å—Å–∫–∏–π –±–∞–Ω–∫",
    "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ-–ß–µ—Ä–Ω–æ–∑–µ–º–Ω—ã–π –±–∞–Ω–∫",
    "–Æ–≥–æ-–ó–∞–ø–∞–¥–Ω—ã–π –±–∞–Ω–∫"
]

# –ì–æ–ª–æ–≤–Ω—ã–µ –æ—Ç–¥–µ–ª–µ–Ω–∏—è (–ì–û–°–ë) - 106 –Ω–∞–∑–≤–∞–Ω–∏–π
HEAD_OFFICES = [
    # –ë–∞–π–∫–∞–ª—å—Å–∫–∏–π –±–∞–Ω–∫ (5 –ì–û–°–ë)
    "–ê–ø–ø–∞—Ä–∞—Ç –ë–∞–π–∫–∞–ª—å—Å–∫–æ–≥–æ –ë–∞–Ω–∫–∞",
    "–ë—É—Ä—è—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8601",
    "–ò—Ä–∫—É—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8586",
    "–ß–∏—Ç–∏–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8600",
    "–Ø–∫—É—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8603",
    
    # –í–æ–ª–≥–æ-–í—è—Ç—Å–∫–∏–π –±–∞–Ω–∫ (12 –ì–û–°–ë)
    "–ê–ø–ø–∞—Ä–∞—Ç –í–æ–ª–≥–æ-–í—è—Ç—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞",
    "–ë–∞–Ω–∫ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω –ì–û–°–ë ‚Ññ8610",
    "–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8611",
    "–ì–æ–ª–æ–≤–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
    "–ö–∏—Ä–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8612",
    "–ú–∞—Ä–∏–π –≠–ª –ì–û–°–ë ‚Ññ8614",
    "–ú–æ—Ä–¥–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8589",
    "–ü–µ—Ä–º—Å–∫–æ–µ –ì–û–°–ë ‚Ññ6984",
    "–£–¥–º—É—Ä—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8618",
    "–ß—É–≤–∞—à—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8613",
    
    # –î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–π –±–∞–Ω–∫ (9 –ì–û–°–ë)
    "–ê–ø–ø–∞—Ä–∞—Ç –î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω–æ–≥–æ –±–∞–Ω–∫–∞",
    "–ë–∏—Ä–æ–±–∏–¥–∂–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ4157",
    "–ë–ª–∞–≥–æ–≤–µ—â–µ–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8636",
    "–ö–∞–º—á–∞—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8556",
    "–ü—Ä–∏–º–æ—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8635",
    "–°–µ–≤–µ—Ä–æ-–í–æ—Å—Ç–æ—á–Ω–æ–µ –ì–û–°–ë ‚Ññ8645",
    "–•–∞–±–∞—Ä–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ9070",
    "–ß—É–∫–æ—Ç—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8557",
    "–Æ–∂–Ω–æ-–°–∞—Ö–∞–ª–∏–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8567",
    
    # –ú–æ—Å–∫–æ–≤—Å–∫–∏–π –±–∞–Ω–∫ (5 –ì–û–°–ë)
    "–£–ü–†–ê–í–õ–ï–ù–ò–ï –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã",
    "–£–ü–†–ê–í–õ–ï–ù–ò–ï –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏",
    "–£–ü–†–ê–í–õ–ï–ù–ò–ï –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏ —Å—Ñ–µ—Ä—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏",
    "–£–ü–†–ê–í–õ–ï–ù–ò–ï –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏ —Å—Ñ–µ—Ä—ã —É—Å–ª—É–≥",
    "–£–ü–†–ê–í–õ–ï–ù–ò–ï –ø–æ —Ä–∞–±–æ—Ç–µ —Å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è–º–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏",
    
    # –ü–æ–≤–æ–ª–∂—Å–∫–∏–π –±–∞–Ω–∫ (8 –ì–û–°–ë)
    "–ê–ø–ø–∞—Ä–∞—Ç –ü–æ–≤–æ–ª–∂—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞",
    "–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8625",
    "–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8621",
    "–û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8623",
    "–ü–µ–Ω–∑–µ–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8624",
    "–°–∞–º–∞—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ6991",
    "–°–∞—Ä–∞—Ç–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8622",
    "–£–ª—å—è–Ω–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8588",
    
    # –°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –±–∞–Ω–∫ (10 –ì–û–°–ë)
    "–ê–ø–ø–∞—Ä–∞—Ç –°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω–æ–≥–æ –±–∞–Ω–∫–∞",
    "–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8637",
    "–í–æ–ª–æ–≥–æ–¥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8638",
    "–ì–û –ø–æ –≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥—É",
    "–ì–û –ø–æ –õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
    "–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8626",
    "–ö–∞—Ä–µ–ª—å—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8628",
    "–ö–æ–º–∏ –ì–û–°–ë ‚Ññ8617",
    "–ú—É—Ä–º–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8627",
    "–ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8629",
    "–ü—Å–∫–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8630",
    
    # –°–∏–±–∏—Ä—Å–∫–∏–π –±–∞–Ω–∫ (8 –ì–û–°–ë)
    "–ê–±–∞–∫–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8602",
    "–ê–ª—Ç–∞–π—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8644",
    "–ê–ø–ø–∞—Ä–∞—Ç –°–∏–±–∏—Ä—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞",
    "–ö–µ–º–µ—Ä–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8615",
    "–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8646",
    "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8047",
    "–û–º—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8634",
    "–¢–æ–º—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8616",
    
    # –°—Ä–µ–¥–Ω–µ—Ä—É—Å—Å–∫–∏–π –±–∞–Ω–∫ (13 –ì–û–°–ë)
    "–ê–ø–ø–∞—Ä–∞—Ç –°—Ä–µ–¥–Ω–µ—Ä—É—Å—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞",
    "–ë—Ä—è–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8605",
    "–í–æ—Å—Ç–æ—á–Ω–æ–µ –ì–û–°–ë ‚Ññ1023",
    "–ó–∞–ø–∞–¥–Ω–æ–µ –ì–û–°–ë ‚Ññ1025",
    "–ò–≤–∞–Ω–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8639",
    "–ö–∞–ª—É–∂—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8608",
    "–ö–æ—Å—Ç—Ä–æ–º—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8640",
    "–†—è–∑–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8606",
    "–°–µ–≤–µ—Ä–Ω–æ–µ –ì–û–°–ë ‚Ññ1026",
    "–°–º–æ–ª–µ–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8609",
    "–¢–≤–µ—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8607",
    "–¢—É–ª—å—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8604",
    "–Æ–∂–Ω–æ–µ –ì–û–°–ë ‚Ññ1024",
    "–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ17",
    
    # –£—Ä–∞–ª—å—Å–∫–∏–π –±–∞–Ω–∫ (7 –ì–û–°–ë)
    "–ê–ø–ø–∞—Ä–∞—Ç –£—Ä–∞–ª—å—Å–∫–æ–≥–æ –±–∞–Ω–∫–∞",
    "–ë–∞—à–∫–∏—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8598",
    "–ó–∞–ø–∞–¥–Ω–æ-–°–∏–±–∏—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8647",
    "–ö—É—Ä–≥–∞–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8599",
    "–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ7003",
    "–ß–µ–ª—è–±–∏–Ω—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8597",
    "–Æ–≥–æ—Ä—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ ‚Ññ5940",
    "–Ø–º–∞–ª–æ-–ù–µ–Ω–µ—Ü–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ ‚Ññ8369",
    
    # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ-–ß–µ—Ä–Ω–æ–∑–µ–º–Ω—ã–π –±–∞–Ω–∫ (8 –ì–û–°–ë)
    "–ê–ø–ø–∞—Ä–∞—Ç –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ-–ß–µ—Ä–Ω–æ–∑–µ–º–Ω–æ–≥–æ –±–∞–Ω–∫–∞",
    "–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8592",
    "–ì–û –ø–æ –í–æ—Ä–æ–Ω–µ–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
    "–ì–æ–ª–æ–≤–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –ø–æ –õ–ù–†",
    "–ö—É—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8596",
    "–õ–∏–ø–µ—Ü–∫–æ–µ –ì–û–°–ë ‚Ññ8593",
    "–û—Ä–ª–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8595",
    "–¢–∞–º–±–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8594",
    
    # –Æ–≥–æ-–ó–∞–ø–∞–¥–Ω—ã–π –±–∞–Ω–∫ (12 –ì–û–°–ë)
    "–ê–¥—ã–≥–µ–π—Å–∫–æ–µ –û–°–ë ‚Ññ8620",
    "–ê–ø–ø–∞—Ä–∞—Ç –Æ–≥–æ-–ó–∞–ø–∞–¥–Ω–æ–≥–æ –±–∞–Ω–∫–∞",
    "–ì–æ–ª–æ–≤–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –ø–æ –î–ù–†",
    "–ì–æ–ª–æ–≤–Ω–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ –ø–æ –†–µ—Å–ø—É–±–ª–∏–∫–µ –ö—Ä—ã–º",
    "–ò–Ω–≥—É—à—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ ‚Ññ 8633",
    "–ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä—Å–∫–æ–µ –û–°–ë ‚Ññ8631",
    "–ö–∞–ª–º—ã—Ü–∫–æ–µ –û–°–ë ‚Ññ8579",
    "–ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å—Å–∫–æ–µ –û–°–ë ‚Ññ8585",
    "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–æ–µ –ì–û–°–ë ‚Ññ8619",
    "–†–æ—Å—Ç–æ–≤—Å–∫–æ–µ –ì–û–°–ë ‚Ññ5221",
    "–°–µ–≤–µ—Ä–æ-–û—Å–µ—Ç–∏–Ω—Å–∫–æ–µ –û–°–ë ‚Ññ8632",
    "–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–æ–µ –ì–û–°–ë ‚Ññ5230",
    "–ß–µ—á–µ–Ω—Å–∫–æ–µ –û–°–ë ‚Ññ8643"
]

# –°–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
LOG_MESSAGES = {
    "start": "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—â–µ–Ω–∞",
    "end": "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞",
    "processing_start": "–ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö",
    "processing_end": "–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞",
    "file_loaded": "–§–∞–π–ª {} –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ",
    "file_saved": "–§–∞–π–ª {} —Å–æ—Ö—Ä–∞–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ",
    "error": "–û—à–∏–±–∫–∞: {}",
    "summary": "–°–≤–æ–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {}",
    "time_elapsed": "–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {:.2f} —Å–µ–∫—É–Ω–¥",
    "files_processed": "–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: {}",
    "outputs_created": "–°–æ–∑–¥–∞–Ω–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: {}",
    "errors_count": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫: {}",
    "test_data_created": "–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ",
    "test_file_created": "–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª: {}",
    "test_data_info": "–¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç {} —Å—Ç—Ä–æ–∫ –∏ {} —Å—Ç–æ–ª–±—Ü–æ–≤",
    "data_generation_start": "–ù–∞—á–∞–ª–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
    "data_generation_end": "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞",
    "employees_created": "–°–æ–∑–¥–∞–Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {}",
    "tb_distribution": "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¢–ë: {}",
    "gosb_distribution": "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ì–û–°–ë: {}",
    "effective_distribution": "–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö: {}",
    "directory_ready": "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è {} –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ",
    "tb_mapping_created": "–°–æ–∑–¥–∞–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ì–û–°–ë –ø–æ –¢–ë: {} –¢–ë",
    "progress_employees": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {}",
    "unique_tn_fio": "–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {}",
    "duplicate_tn_error": "–û–®–ò–ë–ö–ê: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–µ–ª—å–Ω—ã—Ö –Ω–æ–º–µ—Ä–æ–≤!",
    "duplicate_fio_error": "–û–®–ò–ë–ö–ê: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –§–ò–û!",
    "file_saved_debug": "–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {}",
    "file_size_debug": "–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {} —Å—Ç—Ä–æ–∫, {} —Å—Ç–æ–ª–±—Ü–æ–≤",
    "generation_error": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {}",
    "save_error": "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {}",
    "details_error": "–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏: {}",
    "file_not_found": "–§–∞–π–ª {} –Ω–µ –Ω–∞–π–¥–µ–Ω",
    "load_file_error": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞ {}: {}",
    "no_data_to_process": "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏",
    "no_data_to_save": "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è",
    "data_processed": "–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö: {} —Å—Ç—Ä–æ–∫",
    "rows_columns_loaded": "–ó–∞–≥—Ä—É–∂–µ–Ω–æ {} —Å—Ç—Ä–æ–∫ –∏ {} —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞ {}",
    "duplicates_removed": "–£–¥–∞–ª–µ–Ω–æ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: {}",
    "missing_values_filled": "–ó–∞–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π: {}",
    "processing_error": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö: {}",
    "critical_error": "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {}",
    "mode_create_test": "–†–µ–∂–∏–º: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
    "mode_process": "–†–µ–∂–∏–º: –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö",
    "test_data_success": "–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É INPUT.",
    "process_success": "–ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É OUTPUT –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.",
    "main_critical_error": "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã: {}",
    "file_saved_debug_old": "–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {}",
    "analysis_file1": "=== –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ 1 (31 –∏—é–ª—è 2025 –≥–æ–¥–∞) ===",
    "analysis_file2": "=== –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ 2 (20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞) ===",
    "analysis_overlap": "=== –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ ===",
    "employees_2024": "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ 2024: {}",
    "employees_2025": "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ 2025: {}",
    "overlap_info": "–ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ): {} ({:.1f}%)",
    "new_employees_info": "–ù–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {} ({:.1f}%)",
    "removed_employees_info": "–£–±—Ä–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {} ({:.1f}%)",
    "unique_tn_fio_file1": "–§–∞–π–ª 1 - –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {}",
    "unique_tn_fio_file2": "–§–∞–π–ª 2 - –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {}"
}

# =============================================================================
# –ö–õ–ê–°–° –î–õ–Ø –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø
# =============================================================================

class DataProcessorLogger:
    """–ö–ª–∞—Å—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
    
    def __init__(self, log_dir, log_name, log_extension, suffix_format, level="INFO"):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–≥–µ—Ä–∞
        
        Args:
            log_dir (str): –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –ª–æ–≥–æ–≤
            log_name (str): –ò–º—è –ª–æ–≥-—Ñ–∞–π–ª–∞ –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
            log_extension (str): –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ª–æ–≥-—Ñ–∞–π–ª–∞
            suffix_format (str): –§–æ—Ä–º–∞—Ç —Å—É—Ñ—Ñ–∏–∫—Å–∞ –¥–ª—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
            level (str): –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (INFO/DEBUG)
        """
        self.log_dir = Path(log_dir)
        self.log_name = log_name
        self.log_extension = log_extension
        self.suffix_format = suffix_format
        self.level = level.upper()
        
        # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ª–æ–≥–æ–≤ –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
        self.log_dir.mkdir(parents=True, exist_ok=True)
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º—è –ª–æ–≥-—Ñ–∞–π–ª–∞ —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º
        timestamp = datetime.now().strftime(suffix_format.replace("YYYY", "%Y").replace("MM", "%m").replace("DD", "%d"))
        self.log_filename = f"{log_name}-{level}{timestamp}{log_extension}"
        self.log_filepath = self.log_dir / self.log_filename
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        self._setup_logging()
    
    def _setup_logging(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"""
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        log_level = logging.DEBUG if self.level == "DEBUG" else logging.INFO
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä
        formatter = logging.Formatter(
            '%(asctime)s - %(levelname)s - %(message)s',
            datefmt='%Y-%m-%d %H:%M:%S'
        )
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ñ–∞–π–ª–æ–≤—ã–π —Ö–µ–Ω–¥–ª–µ—Ä
        file_handler = logging.FileHandler(self.log_filepath, encoding='utf-8')
        file_handler.setLevel(log_level)
        file_handler.setFormatter(formatter)
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ö–µ–Ω–¥–ª–µ—Ä
        console_handler = logging.StreamHandler()
        console_handler.setLevel(log_level)
        console_handler.setFormatter(formatter)
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–æ—Ä–Ω–µ–≤–æ–π –ª–æ–≥–≥–µ—Ä
        self.logger = logging.getLogger(__name__)
        self.logger.setLevel(log_level)
        self.logger.addHandler(file_handler)
        self.logger.addHandler(console_handler)
        
        # –û—á–∏—â–∞–µ–º —Ö–µ–Ω–¥–ª–µ—Ä—ã —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
        self.logger.handlers.clear()
        self.logger.addHandler(file_handler)
        self.logger.addHandler(console_handler)
    
    def log_info(self, message):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è"""
        self.logger.info(message)
    
    def log_debug(self, message):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è"""
        self.logger.debug(message)
    
    def log_error(self, message):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"""
        self.logger.error(message)
    
    def log_start(self):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
        self.log_info(LOG_MESSAGES["start"])
    
    def log_end(self):
        """–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
        self.log_info(LOG_MESSAGES["end"])

# =============================================================================
# –ö–õ–ê–°–° –î–õ–Ø –°–û–ó–î–ê–ù–ò–Ø –¢–ï–°–¢–û–í–´–• –î–ê–ù–ù–´–•
# =============================================================================

class TestDataGenerator:
    """–ö–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
    
    def __init__(self, work_dir, logger):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        
        Args:
            work_dir (str): –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
            logger (DataProcessorLogger): –û–±—ä–µ–∫—Ç –ª–æ–≥–≥–µ—Ä–∞
        """
        self.work_dir = Path(work_dir)
        self.logger = logger
        self.start_time = None
        self.errors_count = 0
        self.files_created = 0
        self.employees_created = 0
        
        # –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        self._create_directories()
        
        # –°–æ–∑–¥–∞–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ì–û–°–ë –ø–æ –¢–ë
        self._create_tb_gosb_mapping()
    
    def _create_directories(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π"""
        directories = [
            self.work_dir / INPUT_FOLDER,
            self.work_dir / OUTPUT_FOLDER,
            self.work_dir / LOGS_FOLDER
        ]
        
        for directory in directories:
            directory.mkdir(parents=True, exist_ok=True)
            self.logger.log_debug(LOG_MESSAGES["directory_ready"].format(directory))
    
    def _create_tb_gosb_mapping(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ì–û–°–ë –ø–æ –¢–ë"""
        self.tb_gosb_mapping = {}
        current_index = 0
        
        for tb in TERRITORIAL_BANKS:
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ì–û–°–ë –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –¢–ë
            if tb == "–ë–∞–π–∫–∞–ª—å—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 5
            elif tb == "–í–æ–ª–≥–æ-–í—è—Ç—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 12
            elif tb == "–î–∞–ª—å–Ω–µ–≤–æ—Å—Ç–æ—á–Ω—ã–π –±–∞–Ω–∫":
                gosb_count = 9
            elif tb == "–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 5
            elif tb == "–ü–æ–≤–æ–ª–∂—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 8
            elif tb == "–°–µ–≤–µ—Ä–æ-–ó–∞–ø–∞–¥–Ω—ã–π –±–∞–Ω–∫":
                gosb_count = 10
            elif tb == "–°–∏–±–∏—Ä—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 8
            elif tb == "–°—Ä–µ–¥–Ω–µ—Ä—É—Å—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 13
            elif tb == "–£—Ä–∞–ª—å—Å–∫–∏–π –±–∞–Ω–∫":
                gosb_count = 7
            elif tb == "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ-–ß–µ—Ä–Ω–æ–∑–µ–º–Ω—ã–π –±–∞–Ω–∫":
                gosb_count = 8
            elif tb == "–Æ–≥–æ-–ó–∞–ø–∞–¥–Ω—ã–π –±–∞–Ω–∫":
                gosb_count = 12
            else:
                gosb_count = 10
            
            # –ë–µ—Ä–µ–º –ì–û–°–ë –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –¢–ë
            self.tb_gosb_mapping[tb] = HEAD_OFFICES[current_index:current_index + gosb_count]
            current_index += gosb_count
        
        self.logger.log_debug(LOG_MESSAGES["tb_mapping_created"].format(len(self.tb_gosb_mapping)))
    
    def _generate_tn(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∞–±–µ–ª—å–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ (10 –∑–Ω–∞–∫–æ–≤, —Å–ø—Ä–∞–≤–∞ –∑–Ω–∞—á–∞—â–∏–µ)"""
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 9999999999
        tn_number = np.random.randint(1, 10000000000)
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤ 10 –∑–Ω–∞–∫–æ–≤ —Å –≤–µ–¥—É—â–∏–º–∏ –Ω—É–ª—è–º–∏
        return f"{tn_number:010d}"
    
    def _generate_fio(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –§–ò–û"""
        # –°–ø–∏—Å–∫–∏ –∏–º–µ–Ω, —Ñ–∞–º–∏–ª–∏–π –∏ –æ—Ç—á–µ—Å—Ç–≤
        first_names_male = [
            "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–°–µ—Ä–≥–µ–π", "–í–ª–∞–¥–∏–º–∏—Ä", "–î–º–∏—Ç—Ä–∏–π", "–ê–Ω–¥—Ä–µ–π", "–ê–ª–µ–∫—Å–µ–π", "–ú–∞–∫—Å–∏–º", "–ò–≤–∞–Ω", "–ú–∏—Ö–∞–∏–ª", "–ù–∏–∫–æ–ª–∞–π",
            "–ê—Ä—Ç–µ–º", "–î–µ–Ω–∏—Å", "–ï–≤–≥–µ–Ω–∏–π", "–î–∞–Ω–∏–∏–ª", "–†–æ–º–∞–Ω", "–¢–∏–º—É—Ä", "–í–ª–∞–¥–∏—Å–ª–∞–≤", "–ü–∞–≤–µ–ª", "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω", "–ò–≥–æ—Ä—å"
        ]
        
        first_names_female = [
            "–ê–Ω–Ω–∞", "–ú–∞—Ä–∏—è", "–ï–ª–µ–Ω–∞", "–û–ª—å–≥–∞", "–¢–∞—Ç—å—è–Ω–∞", "–ù–∞—Ç–∞–ª—å—è", "–ò—Ä–∏–Ω–∞", "–°–≤–µ—Ç–ª–∞–Ω–∞", "–Æ–ª–∏—è", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞",
            "–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–î–∞—Ä—å—è", "–ö—Å–µ–Ω–∏—è", "–í–∏–∫—Ç–æ—Ä–∏—è", "–ü–æ–ª–∏–Ω–∞", "–ê–ª–∏—Å–∞", "–°–æ—Ñ–∏—è", "–í–µ—Ä–æ–Ω–∏–∫–∞", "–ê—Ä–∏–Ω–∞", "–î–∏–∞–Ω–∞"
        ]
        
        last_names = [
            "–ò–≤–∞–Ω–æ–≤", "–°–º–∏—Ä–Ω–æ–≤", "–ö—É–∑–Ω–µ—Ü–æ–≤", "–ü–æ–ø–æ–≤", "–í–∞—Å–∏–ª—å–µ–≤", "–ü–µ—Ç—Ä–æ–≤", "–°–æ–∫–æ–ª–æ–≤", "–ú–∏—Ö–∞–π–ª–æ–≤", "–ù–æ–≤–∏–∫–æ–≤", "–§–µ–¥–æ—Ä–æ–≤",
            "–ú–æ—Ä–æ–∑–æ–≤", "–í–æ–ª–∫–æ–≤", "–ê–ª–µ–∫—Å–µ–µ–≤", "–õ–µ–±–µ–¥–µ–≤", "–°–µ–º–µ–Ω–æ–≤", "–ï–≥–æ—Ä–æ–≤", "–ü–∞–≤–ª–æ–≤", "–ö–æ–∑–ª–æ–≤", "–°—Ç–µ–ø–∞–Ω–æ–≤", "–ù–∏–∫–æ–ª–∞–µ–≤"
        ]
        
        middle_names_male = [
            "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á", "–°–µ—Ä–≥–µ–µ–≤–∏—á", "–í–ª–∞–¥–∏–º–∏—Ä–æ–≤–∏—á", "–î–º–∏—Ç—Ä–∏–µ–≤–∏—á", "–ê–Ω–¥—Ä–µ–µ–≤–∏—á", "–ê–ª–µ–∫—Å–µ–µ–≤–∏—á", "–ú–∞–∫—Å–∏–º–æ–≤–∏—á", "–ò–≤–∞–Ω–æ–≤–∏—á", "–ú–∏—Ö–∞–π–ª–æ–≤–∏—á", "–ù–∏–∫–æ–ª–∞–µ–≤–∏—á"
        ]
        
        middle_names_female = [
            "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞", "–°–µ—Ä–≥–µ–µ–≤–Ω–∞", "–í–ª–∞–¥–∏–º–∏—Ä–æ–≤–Ω–∞", "–î–º–∏—Ç—Ä–∏–µ–≤–Ω–∞", "–ê–Ω–¥—Ä–µ–µ–≤–Ω–∞", "–ê–ª–µ–∫—Å–µ–µ–≤–Ω–∞", "–ú–∞–∫—Å–∏–º–æ–≤–Ω–∞", "–ò–≤–∞–Ω–æ–≤–Ω–∞", "–ú–∏—Ö–∞–π–ª–æ–≤–Ω–∞", "–ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞"
        ]
        
        # –í—ã–±–∏—Ä–∞–µ–º –ø–æ–ª —Å–ª—É—á–∞–π–Ω–æ
        is_male = np.random.choice([True, False])
        
        if is_male:
            first_name = np.random.choice(first_names_male)
            middle_name = np.random.choice(middle_names_male)
        else:
            first_name = np.random.choice(first_names_female)
            middle_name = np.random.choice(middle_names_female)
        
        last_name = np.random.choice(last_names)
        
        return f"{last_name} {first_name} {middle_name}"
    
    def _generate_effective_status(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
        # 80% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö, 20% –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö
        is_effective = np.random.random() < DATA_PARAMS["effective_share"]
        return "üëç" if is_effective else "üëé"
    
    def _generate_operational_income_data(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–± –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º –¥–æ—Ö–æ–¥–µ"""
        # –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è 2025
        income_july = np.random.randint(DATA_PARAMS["operational_income_july_min"], DATA_PARAMS["operational_income_july_max"] + 1)
        
        # –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ >= –∏—é–ª—å—Å–∫–æ–≥–æ)
        # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ = –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π = –∑–∞–¥–∞–Ω–Ω—ã–π –º–∞–∫—Å–∏–º—É–º
        income_august = np.random.randint(income_july, DATA_PARAMS["operational_income_august_max"] + 1)
        
        # –ü—Ä–∏—Ä–æ—Å—Ç –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
        growth_percent = ((income_august - income_july) / income_july * 100) if income_july > 0 else 0
        
        # –ü—Ä–∏—Ä–æ—Å—Ç –≤ —Ç—ã—Å. —Ä—É–±.
        growth_amount = income_august - income_july
        
        # –û–î –∫–æ–Ω–µ—Ü –∫–≤–∞—Ä—Ç–∞–ª–∞ = –∞–≤–≥—É—Å—Ç 2025
        od_quarter = income_august
        
        return {
            'operational_income_july': income_july,
            'operational_income_august': income_august,
            'growth_percent': round(growth_percent, 2),
            'growth_amount': growth_amount,
            'od_quarter': income_august
        }
    
    def create_sample_data(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"""
        self.start_time = time.time()
        
        try:
            self.logger.log_info(LOG_MESSAGES["data_generation_start"])
            
            # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–∫–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
            data1 = []  # –î–∞–Ω–Ω—ã–µ –Ω–∞ 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
            data2 = []  # –î–∞–Ω–Ω—ã–µ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞
            used_fios = set()
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–∞–∑–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –¥–ª—è 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
            base_employees = []
            for i in range(DATA_PARAMS["total_employees"]):
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –§–ò–û
                while True:
                    fio = self._generate_fio()
                    if fio not in used_fios:
                        used_fios.add(fio)
                        break
                
                # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –¢–ë –∏ –ì–û–°–ë
                tb = np.random.choice(TERRITORIAL_BANKS)
                gosb = np.random.choice(self.tb_gosb_mapping[tb])
                
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
                tn = self._generate_tn()
                effective_status = self._generate_effective_status()
                
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –±–∞–∑–æ–≤—ã–π –¥–æ—Ö–æ–¥ (–∫–∞–∫ –±—ã –Ω–∞ –Ω–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞) –∏ –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è
                # –ë–∞–∑–æ–≤—ã–π –¥–æ—Ö–æ–¥ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 60% –¥–æ 90% –æ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞ –∏—é–ª—è
                base_income_min = int(DATA_PARAMS["operational_income_july_min"] * 0.6)
                base_income_max = int(DATA_PARAMS["operational_income_july_min"] * 0.9)
                base_income = np.random.randint(base_income_min, base_income_max + 1)
                income_july = np.random.randint(DATA_PARAMS["operational_income_july_min"], DATA_PARAMS["operational_income_july_max"] + 1)
                
                # –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–∏—Ä–æ—Å—Ç –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –¥–æ—Ö–æ–¥–∞ –¥–æ 31 –∏—é–ª—è
                growth_percent_july = ((income_july - base_income) / base_income * 100) if base_income > 0 else 0
                growth_amount_july = income_july - base_income
                
                # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
                row_july = {
                    '–ò–ù–î (–¢–ë_–ì–û–°–ë_–¢–ù)': f"{tb}_{gosb}_{tn}",
                    '–ò–ù–î (–¢–ë_–ì–û–°–ë_–§–ò–û)': f"{tb}_{gosb}_{fio}",
                    '–¢–ù 10': tn,
                    '–¢–ë': tb,
                    '–ì–û–°–ë': gosb,
                    '–ö–ú': fio,
                    '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú': effective_status,
                    '2025, —Ç—ã—Å. —Ä—É–±.': income_july,
                    '2024, —Ç—ã—Å. —Ä—É–±. –Ω–∞ –∫–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞': base_income,
                    '–ü—Ä–∏—Ä–æ—Å—Ç, %': round(growth_percent_july, 2),
                    '–ü—Ä–∏—Ä–æ—Å—Ç, —Ç—ã—Å. —Ä—É–±.': growth_amount_july,
                    '–û–î –∫–æ–Ω–µ—Ü –∫–≤–∞—Ä—Ç–∞–ª–∞, —Ç—ã—Å. —Ä—É–±.': income_july
                }
                
                data1.append(row_july)
                base_employees.append({
                    'fio': fio,
                    'tn': tn,
                    'tb': tb,
                    'gosb': gosb,
                    'effective_status': effective_status,
                    'income_july': income_july
                })
                
                # –õ–æ–≥–∏—Ä—É–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 100 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
                if (i + 1) % 100 == 0:
                    self.logger.log_debug(LOG_MESSAGES["progress_employees"].format(i + 1))
            
            # –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è 20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞
            # 90% —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –æ—Å—Ç–∞—é—Ç—Å—è, 5% –Ω–æ–≤—ã—Ö, 5% —É–±–∏—Ä–∞–µ–º
            overlap_count = int(DATA_PARAMS["total_employees"] * DATA_PARAMS["employee_overlap"])
            new_count = int(DATA_PARAMS["total_employees"] * DATA_PARAMS["new_employees_share"])
            removed_count = DATA_PARAMS["total_employees"] - overlap_count - new_count
            
            # –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è (90%)
            remaining_employees = np.random.choice(base_employees, overlap_count, replace=False)
            
            # –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
            for emp in remaining_employees:
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–æ—Ö–æ–¥ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ (>= –¥–æ—Ö–æ–¥–∞ –Ω–∞ 31 –∏—é–ª—è)
                # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ = –¥–æ—Ö–æ–¥ –Ω–∞ 31 –∏—é–ª—è, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π = –∑–∞–¥–∞–Ω–Ω—ã–π –º–∞–∫—Å–∏–º—É–º
                income_august = np.random.randint(emp['income_july'], DATA_PARAMS["operational_income_august_max"] + 1)
                
                # –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–∏—Ä–æ—Å—Ç
                growth_percent = ((income_august - emp['income_july']) / emp['income_july'] * 100) if emp['income_july'] > 0 else 0
                growth_amount = income_august - emp['income_july']
                
                row_august = {
                    '–ò–ù–î (–¢–ë_–ì–û–°–ë_–¢–ù)': f"{emp['tb']}_{emp['gosb']}_{emp['tn']}",
                    '–ò–ù–î (–¢–ë_–ì–û–°–ë_–§–ò–û)': f"{emp['tb']}_{emp['gosb']}_{emp['fio']}",
                    '–¢–ù 10': emp['tn'],
                    '–¢–ë': emp['tb'],
                    '–ì–û–°–ë': emp['gosb'],
                    '–ö–ú': emp['fio'],
                    '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú': emp['effective_status'],
                    '2025, —Ç—ã—Å. —Ä—É–±.': income_august,
                    '2024, —Ç—ã—Å. —Ä—É–±. –Ω–∞ –∫–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞': emp['income_july'],
                    '–ü—Ä–∏—Ä–æ—Å—Ç, %': round(growth_percent, 2),
                    '–ü—Ä–∏—Ä–æ—Å—Ç, —Ç—ã—Å. —Ä—É–±.': growth_amount,
                    '–û–î –∫–æ–Ω–µ—Ü –∫–≤–∞—Ä—Ç–∞–ª–∞, —Ç—ã—Å. —Ä—É–±.': income_august
                }
                
                data2.append(row_august)
            
            # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (5%)
            for i in range(new_count):
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –§–ò–û
                while True:
                    fio = self._generate_fio()
                    if fio not in used_fios:
                        used_fios.add(fio)
                        break
                
                # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –¢–ë –∏ –ì–û–°–ë
                tb = np.random.choice(TERRITORIAL_BANKS)
                gosb = np.random.choice(self.tb_gosb_mapping[tb])
                
                # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                tn = self._generate_tn()
                effective_status = self._generate_effective_status()
                income_data = self._generate_operational_income_data()
                
                # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                row_august = {
                    '–ò–ù–î (–¢–ë_–ì–û–°–ë_–¢–ù)': f"{tb}_{gosb}_{tn}",
                    '–ò–ù–î (–¢–ë_–ì–û–°–ë_–§–ò–û)': f"{tb}_{gosb}_{fio}",
                    '–¢–ù 10': tn,
                    '–¢–ë': tb,
                    '–ì–û–°–ë': gosb,
                    '–ö–ú': fio,
                    '–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú': effective_status,
                    '2025, —Ç—ã—Å. —Ä—É–±.': income_data['operational_income_august'],
                    '2024, —Ç—ã—Å. —Ä—É–±. –Ω–∞ –∫–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞': income_data['operational_income_july'],
                    '–ü—Ä–∏—Ä–æ—Å—Ç, %': income_data['growth_percent'],
                    '–ü—Ä–∏—Ä–æ—Å—Ç, —Ç—ã—Å. —Ä—É–±.': income_data['growth_amount'],
                    '–û–î –∫–æ–Ω–µ—Ü –∫–≤–∞—Ä—Ç–∞–ª–∞, —Ç—ã—Å. —Ä—É–±.': income_data['od_quarter']
                }
                
                data2.append(row_august)
            
            # –°–æ–∑–¥–∞–µ–º DataFrame'—ã
            df1 = pd.DataFrame(data1)  # –î–∞–Ω–Ω—ã–µ –Ω–∞ 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
            df2 = pd.DataFrame(data2)  # –î–∞–Ω–Ω—ã–µ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞
            self.employees_created = len(df1) + len(df2)
            
            # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
            self._analyze_distribution(df1, df2)
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª—ã
            self._save_data_files(df1, df2)
            
            self.logger.log_info(LOG_MESSAGES["data_generation_end"])
            
        except Exception as e:
            error_msg = LOG_MESSAGES["generation_error"].format(str(e))
            self.logger.log_error(error_msg)
            self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
            self.errors_count += 1
        
        finally:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–≤–æ–¥–∫—É
            self._generate_summary()
    
    def _analyze_distribution(self, df1, df2):
        """–ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –¥–≤—É–º —Ñ–∞–π–ª–∞–º"""
        # –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ 1 (31 –∏—é–ª—è 2025 –≥–æ–¥–∞)
        self.logger.log_info(LOG_MESSAGES["analysis_file1"])
        tb_distribution_1 = df1['–¢–ë'].value_counts()
        self.logger.log_info(LOG_MESSAGES["tb_distribution"].format(dict(tb_distribution_1)))
        
        effective_distribution_1 = df1['–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú'].value_counts()
        self.logger.log_info(LOG_MESSAGES["effective_distribution"].format(dict(effective_distribution_1)))
        
        # –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ 2 (20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞)
        self.logger.log_info(LOG_MESSAGES["analysis_file2"])
        tb_distribution_2 = df2['–¢–ë'].value_counts()
        self.logger.log_info(LOG_MESSAGES["tb_distribution"].format(dict(tb_distribution_2)))
        
        effective_distribution_2 = df2['–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú'].value_counts()
        self.logger.log_info(LOG_MESSAGES["effective_distribution"].format(dict(effective_distribution_2)))
        
        # –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
        self.logger.log_info(LOG_MESSAGES["analysis_overlap"])
        employees_july = set(df1['–ö–ú'])
        employees_august = set(df2['–ö–ú'])
        
        overlap_employees = employees_july.intersection(employees_august)
        new_employees = employees_august - employees_july
        removed_employees = employees_july - employees_august
        
        self.logger.log_info(f"–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–∞ 31 –∏—é–ª—è: {len(employees_july)}")
        self.logger.log_info(f"–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞: {len(employees_august)}")
        self.logger.log_info(f"–ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ): {len(overlap_employees)} ({len(overlap_employees)/len(employees_july)*100:.1f}%)")
        self.logger.log_info(f"–ù–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {len(new_employees)} ({len(new_employees)/len(employees_august)*100:.1f}%)")
        self.logger.log_info(f"–£–±—Ä–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: {len(removed_employees)} ({len(removed_employees)/len(employees_july)*100:.1f}%)")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –¢–ù –∏ –§–ò–û –≤ –∫–∞–∂–¥–æ–º —Ñ–∞–π–ª–µ
        unique_tn_1 = df1['–¢–ù 10'].nunique()
        unique_fio_1 = df1['–ö–ú'].nunique()
        unique_tn_2 = df2['–¢–ù 10'].nunique()
        unique_fio_2 = df2['–ö–ú'].nunique()
        
        self.logger.log_debug(f"–§–∞–π–ª 1 (31 –∏—é–ª—è) - –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {unique_tn_1}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {unique_fio_1}")
        self.logger.log_debug(f"–§–∞–π–ª 2 (20 –∞–≤–≥—É—Å—Ç–∞) - –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù: {unique_tn_2}, –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –§–ò–û: {unique_fio_2}")
        
        if unique_tn_1 != len(df1):
            self.logger.log_error(LOG_MESSAGES["duplicate_tn_error"])
        if unique_fio_1 != len(df1):
            self.logger.log_error(LOG_MESSAGES["duplicate_fio_error"])
        if unique_tn_2 != len(df2):
            self.logger.log_error(LOG_MESSAGES["duplicate_tn_error"])
        if unique_fio_2 != len(df2):
            self.logger.log_error(LOG_MESSAGES["duplicate_tn_error"])
    
    def _save_data_files(self, df1, df2):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –¥–≤–∞ —Ñ–∞–π–ª–∞"""
        try:
            # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π
            timestamp = datetime.now().strftime("_%Y%m%d_%H%M%S")
            filename1 = f"data1{timestamp}.xlsx"  # –§–∞–π–ª –Ω–∞ 31 –∏—é–ª—è 2025 –≥–æ–¥–∞
            filename2 = f"data2{timestamp}.xlsx"  # –§–∞–π–ª –Ω–∞ 20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞
            
            file_path1 = self.work_dir / INPUT_FOLDER / filename1
            file_path2 = self.work_dir / INPUT_FOLDER / filename2
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª 1 (31 –∏—é–ª—è 2025 –≥–æ–¥–∞)
            df1.to_excel(file_path1, index=False, engine='openpyxl')
            self.logger.log_info(LOG_MESSAGES["test_file_created"].format(filename1))
            self.logger.log_debug(LOG_MESSAGES["file_saved_debug"].format(file_path1))
            self.logger.log_debug(LOG_MESSAGES["file_size_debug"].format(len(df1), len(df1.columns)))
            self.files_created += 1
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª 2 (20 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞)
            df2.to_excel(file_path2, index=False, engine='openpyxl')
            self.logger.log_info(LOG_MESSAGES["test_file_created"].format(filename2))
            self.logger.log_debug(LOG_MESSAGES["file_saved_debug"].format(file_path2))
            self.logger.log_debug(LOG_MESSAGES["file_size_debug"].format(len(df2), len(df2.columns)))
            self.files_created += 1
            
        except Exception as e:
            error_msg = LOG_MESSAGES["save_error"].format(str(e))
            self.logger.log_error(error_msg)
            self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
            self.errors_count += 1
    
    def _generate_summary(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–≤–æ–¥–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
        end_time = time.time()
        execution_time = end_time - self.start_time
        
        summary = {
            'execution_time': execution_time,
            'employees_created': self.employees_created,
            'files_created': self.files_created,
            'errors_count': self.errors_count
        }
        
        # –õ–æ–≥–∏—Ä—É–µ–º —Å–≤–æ–¥–∫—É
        self.logger.log_info(LOG_MESSAGES["summary"].format(summary))
        self.logger.log_info(LOG_MESSAGES["time_elapsed"].format(execution_time))
        self.logger.log_info(LOG_MESSAGES["employees_created"].format(self.employees_created))
        self.logger.log_info(LOG_MESSAGES["outputs_created"].format(self.files_created))
        self.logger.log_info(LOG_MESSAGES["errors_count"].format(self.errors_count))
        
        return summary

# =============================================================================
# –ö–õ–ê–°–° –î–õ–Ø –û–ë–†–ê–ë–û–¢–ö–ò –î–ê–ù–ù–´–•
# =============================================================================

class DataProcessor:
    """–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö"""
    
    def __init__(self, work_dir, logger):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
        
        Args:
            work_dir (str): –†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
            logger (DataProcessorLogger): –û–±—ä–µ–∫—Ç –ª–æ–≥–≥–µ—Ä–∞
        """
        self.work_dir = Path(work_dir)
        self.logger = logger
        self.start_time = None
        self.errors_count = 0
        self.files_processed = 0
        self.outputs_created = 0
        
        # –°–æ–∑–¥–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
        self._create_directories()
    
    def _create_directories(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π"""
        directories = [
            self.work_dir / INPUT_FOLDER,
            self.work_dir / OUTPUT_FOLDER,
            self.work_dir / LOGS_FOLDER
        ]
        
        for directory in directories:
            directory.mkdir(parents=True, exist_ok=True)
            self.logger.log_debug(LOG_MESSAGES["directory_ready"].format(directory))
    
    def load_excel_files(self):
        """
        –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–æ–≤
        
        Returns:
            list: –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö DataFrame'–æ–≤
        """
        dataframes = []
        
        for file_config in INPUT_FILES:
            try:
                file_path = self.work_dir / INPUT_FOLDER / f"{file_config['name']}{file_config['extension']}"
                
                if file_path.exists():
                    # –ó–∞–≥—Ä—É–∂–∞–µ–º Excel —Ñ–∞–π–ª
                    df = pd.read_excel(file_path)
                    dataframes.append({
                        'name': file_config['name'],
                        'data': df,
                        'file_path': file_path
                    })
                    
                    self.logger.log_info(LOG_MESSAGES["file_loaded"].format(file_path.name))
                    self.logger.log_debug(LOG_MESSAGES["rows_columns_loaded"].format(len(df), len(df.columns), file_path.name))
                    self.files_processed += 1
                else:
                    self.logger.log_error(LOG_MESSAGES["file_not_found"].format(file_path))
                    self.errors_count += 1
                    
            except Exception as e:
                error_msg = LOG_MESSAGES["load_file_error"].format(file_config['name'], str(e))
                self.logger.log_error(error_msg)
                self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
                self.errors_count += 1
        
        return dataframes
    
    def process_data(self, dataframes):
        """
        –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –∏ —Ä–∞—Å—á–µ—Ç–æ–º –Ω–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
        
        Args:
            dataframes (list): –°–ø–∏—Å–æ–∫ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö DataFrame'–æ–≤
            
        Returns:
            pd.DataFrame: –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        """
        self.logger.log_info(LOG_MESSAGES["processing_start"])
        
        if not dataframes:
            self.logger.log_error(LOG_MESSAGES["no_data_to_process"])
            return pd.DataFrame()
        
        try:
            # –ù–∞—Ö–æ–¥–∏–º —Ñ–∞–π–ª—ã data1 –∏ data2 –ø–æ –∏–º–µ–Ω–∞–º –∏–∑ INPUT_FILES
            df1 = None
            df2 = None
            
            # –ü–æ–ª—É—á–∞–µ–º –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è)
            file1_name = INPUT_FILES[0]['name']
            file2_name = INPUT_FILES[1]['name']
            
            for df_info in dataframes:
                if df_info['name'] == file1_name:
                    df1 = df_info['data']
                elif df_info['name'] == file2_name:
                    df2 = df_info['data']
            
            if df1 is None or df2 is None:
                self.logger.log_error(f"–ù–µ –Ω–∞–π–¥–µ–Ω—ã —Ñ–∞–π–ª—ã {file1_name}.xlsx –∏–ª–∏ {file2_name}.xlsx")
                return pd.DataFrame()
            
            self.logger.log_debug(f"–ó–∞–≥—Ä—É–∂–µ–Ω—ã —Ñ–∞–π–ª—ã: data1 ({len(df1)} —Å—Ç—Ä–æ–∫), data2 ({len(df2)} —Å—Ç—Ä–æ–∫)")
            
            # –°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¢–ù 10, –¢–ë, –ì–û–°–ë, –§–ò–û
            # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¢–ù –∏–∑ –æ–±–æ–∏—Ö —Ñ–∞–π–ª–æ–≤
            all_tn = pd.concat([
                df1[['–¢–ù 10', '–¢–ë', '–ì–û–°–ë', '–ö–ú']].drop_duplicates(),
                df2[['–¢–ù 10', '–¢–ë', '–ì–û–°–ë', '–ö–ú']].drop_duplicates()
            ]).drop_duplicates(subset=['–¢–ù 10'], keep='last')
            
            self.logger.log_debug(f"–°–æ–∑–¥–∞–Ω —Å–ø–∏—Å–æ–∫ –∏–∑ {len(all_tn)} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¢–ù")
            
            # –°–æ–∑–¥–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π DataFrame
            result_data = []
            
            for _, row in all_tn.iterrows():
                tn = row['–¢–ù 10']
                tb = row['–¢–ë']
                gosb = row['–ì–û–°–ë']
                fio = row['–ö–ú']
                
                # –ò—â–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ 1
                data1_row = df1[df1['–¢–ù 10'] == tn]
                data2_row = df2[df2['–¢–ù 10'] == tn]
                
                # –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ñ–∞–π–ª–∞ 1
                od_current = data1_row['2025, —Ç—ã—Å. —Ä—É–±.'].iloc[0] if len(data1_row) > 0 else 0
                od_previous = data1_row['2024, —Ç—ã—Å. —Ä—É–±. –Ω–∞ –∫–æ–Ω–µ—Ü –º–µ—Å—è—Ü–∞'].iloc[0] if len(data1_row) > 0 else 0
                
                # –ü–æ–ª—É—á–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–∑ —Ñ–∞–π–ª–∞ 2, –µ—Å–ª–∏ –Ω–µ—Ç - –∏–∑ —Ñ–∞–π–ª–∞ 1
                if len(data2_row) > 0:
                    effectiveness = data2_row['–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú'].iloc[0]
                elif len(data1_row) > 0:
                    effectiveness = data1_row['–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ö–ú'].iloc[0]
                else:
                    effectiveness = "üëé"
                
                # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                effectiveness_num = 1 if effectiveness == "üëç" else 0
                
                # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ç–µ–º–ø –û–î
                if od_previous == 0:
                    if od_current > 0:
                        temp_od = 100
                    elif od_current < 0:
                        temp_od = -100
                    else:
                        temp_od = 0
                else:
                    temp_od = (od_current - od_previous) / abs(od_previous) * 100
                
                # –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                result_row = {
                    '–¢–ù 10': tn,
                    '–¢–ë': tb,
                    '–ì–û–°–ë': gosb,
                    '–§–ò–û': fio,
                    '–ò–ù–î (–¢–ë_–ì–û–°–ë_–¢–ù)': f"{tb}_{gosb}_{tn}",
                    '–ò–ù–î (–¢–ë_–ì–û–°–ë_–§–ò–û)': f"{tb}_{gosb}_{fio}",
                    '–ò–ù–î (–¢–ë_–ì–û–°–ë)': f"{tb}_{gosb}",
                    '–û–î –¢–ï–ö–£–©–ò–ô': od_current,
                    '–û–î –ü–†–û–®–õ–´–ô': od_previous,
                    '–≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–¨': effectiveness_num,
                    '–¢–ï–ú–ü –û–î': round(temp_od, 2)
                }
                
                result_data.append(result_row)
            
            # –°–æ–∑–¥–∞–µ–º DataFrame
            result_df = pd.DataFrame(result_data)
            
            # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–Ω–≥–∏ –û–î
            self.logger.log_debug("–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–Ω–≥–∏ –û–î...")
            
            # –†–ê–ù–ì –û–î –î–õ–Ø –£–†–û–í–ù–Ø BANK (–ø–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º)
            result_df['–†–ê–ù–ì –û–î –î–õ–Ø –£–†–û–í–ù–Ø BANK'] = result_df['–û–î –¢–ï–ö–£–©–ò–ô'].rank(method='min', ascending=False)
            
            # –†–ê–ù–ì –û–î –î–õ–Ø –£–†–û–í–ù–Ø TB (–ø–æ –∫–∞–∂–¥–æ–º—É –¢–ë –æ—Ç–¥–µ–ª—å–Ω–æ)
            result_df['–†–ê–ù–ì –û–î –î–õ–Ø –£–†–û–í–ù–Ø TB'] = result_df.groupby('–¢–ë')['–û–î –¢–ï–ö–£–©–ò–ô'].rank(method='min', ascending=False)
            
            # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Ä–∞–Ω–≥–∏ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç—ã
            total_count = len(result_df)
            result_df['–†–ê–ù–ì –û–î –î–õ–Ø –£–†–û–í–ù–Ø BANK'] = (result_df['–†–ê–ù–ì –û–î –î–õ–Ø –£–†–û–í–ù–Ø BANK'] / total_count * 100).round(2)
            
            # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Ä–∞–Ω–≥–∏ –¢–ë –≤ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¢–ë
            for tb in result_df['–¢–ë'].unique():
                tb_mask = result_df['–¢–ë'] == tb
                tb_count = tb_mask.sum()
                result_df.loc[tb_mask, '–†–ê–ù–ì –û–î –î–õ–Ø –£–†–û–í–ù–Ø TB'] = (
                    result_df.loc[tb_mask, '–†–ê–ù–ì –û–î –î–õ–Ø –£–†–û–í–ù–Ø TB'] / tb_count * 100
                ).round(2)
            
            self.logger.log_debug(f"–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö: {len(result_df)} —Å—Ç—Ä–æ–∫, {len(result_df.columns)} –∫–æ–ª–æ–Ω–æ–∫")
            self.logger.log_info(LOG_MESSAGES["processing_end"])
            
            return result_df
            
        except Exception as e:
            error_msg = LOG_MESSAGES["processing_error"].format(str(e))
            self.logger.log_error(error_msg)
            self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
            self.errors_count += 1
            return pd.DataFrame()
    
    def save_outputs(self, processed_data):
        """
        –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
        
        Args:
            processed_data (pd.DataFrame): –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        """
        if processed_data.empty:
            self.logger.log_error(LOG_MESSAGES["no_data_to_save"])
            return
        
        for output_config in OUTPUT_FILES:
            try:
                # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º—è —Ñ–∞–π–ª–∞ —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º
                timestamp = datetime.now().strftime(
                    output_config["suffix_format"]
                    .replace("YYYY", "%Y")
                    .replace("MM", "%m")
                    .replace("DD", "%d")
                    .replace("HH", "%H")
                    .replace("MM", "%M")
                    .replace("SS", "%S")
                )
                
                filename = f"{output_config['name']}{timestamp}{output_config['extension']}"
                file_path = self.work_dir / OUTPUT_FOLDER / filename
                
                # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–æ—Ä–º–∞—Ç–∞
                if output_config['extension'].lower() == '.csv':
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º CSV —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º ";"
                    processed_data.to_csv(file_path, sep=';', index=False, encoding='utf-8')
                elif output_config['extension'].lower() == '.xlsx':
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º Excel
                    processed_data.to_excel(file_path, index=False, engine='openpyxl')
                
                self.logger.log_info(LOG_MESSAGES["file_saved"].format(filename))
                self.logger.log_debug(LOG_MESSAGES["file_saved_debug_old"].format(file_path))
                self.outputs_created += 1
                
            except Exception as e:
                error_msg = LOG_MESSAGES["save_error"].format(f"{output_config['name']}: {str(e)}")
                self.logger.log_error(error_msg)
                self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
                self.errors_count += 1
    
    def generate_summary(self):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–≤–æ–¥–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
        end_time = time.time()
        execution_time = end_time - self.start_time
        
        summary = {
            'execution_time': execution_time,
            'files_processed': self.files_processed,
            'outputs_created': self.outputs_created,
            'errors_count': self.errors_count
        }
        
        # –õ–æ–≥–∏—Ä—É–µ–º —Å–≤–æ–¥–∫—É
        self.logger.log_info(LOG_MESSAGES["summary"].format(summary))
        self.logger.log_info(LOG_MESSAGES["time_elapsed"].format(execution_time))
        self.logger.log_info(LOG_MESSAGES["files_processed"].format(self.files_processed))
        self.logger.log_info(LOG_MESSAGES["outputs_created"].format(self.outputs_created))
        self.logger.log_info(LOG_MESSAGES["errors_count"].format(self.errors_count))
        
        return summary
    
    def run(self):
        """–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –∑–∞–ø—É—Å–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö"""
        self.start_time = time.time()
        
        try:
            # –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            dataframes = self.load_excel_files()
            
            # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            processed_data = self.process_data(dataframes)
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            self.save_outputs(processed_data)
            
        except Exception as e:
            error_msg = LOG_MESSAGES["processing_error"].format(str(e))
            self.logger.log_error(error_msg)
            self.logger.log_debug(LOG_MESSAGES["details_error"].format(traceback.format_exc()))
            self.errors_count += 1
        
        finally:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–≤–æ–¥–∫—É
            self.generate_summary()

# =============================================================================
# –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
# =============================================================================

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
    
    try:
        # –°–æ–∑–¥–∞–µ–º –ª–æ–≥–≥–µ—Ä
        logger = DataProcessorLogger(
            log_dir=Path(WORK_DIR) / LOGS_FOLDER,
            log_name=LOG_FILE["name"],
            log_extension=LOG_FILE["extension"],
            suffix_format=LOG_FILE["suffix_format"],
            level=LOG_LEVEL
        )
        
        # –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
        logger.log_start()
        
        if PROGRAM_MODE == 'create-test':
            # –†–µ–∂–∏–º —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            logger.log_info(LOG_MESSAGES["mode_create_test"])
            generator = TestDataGenerator(WORK_DIR, logger)
            generator.create_sample_data()
            print(LOG_MESSAGES["test_data_success"])
            
        else:
            # –†–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
            logger.log_info(LOG_MESSAGES["mode_process"])
            processor = DataProcessor(WORK_DIR, logger)
            processor.run()
            print(LOG_MESSAGES["process_success"])
        
        # –õ–æ–≥–∏—Ä—É–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
        logger.log_end()
        
    except Exception as e:
        print(LOG_MESSAGES["main_critical_error"].format(str(e)))
        sys.exit(1)

# =============================================================================
# –¢–û–ß–ö–ê –í–•–û–î–ê
# =============================================================================

if __name__ == "__main__":
    main()
